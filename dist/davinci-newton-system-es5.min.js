/*! davinci-newton 2017-01-19 */
System.register("davinci-newton/config.js",[],function(a,b){"use strict";var c,d;b&&b.id;return{setters:[],execute:function(){c=function(){function a(){this.GITHUB="https://github.com/geometryzen/davinci-newton",this.LAST_MODIFIED="2017-01-19",this.NAMESPACE="NEWTON",this.VERSION="0.0.6"}return a.prototype.log=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];console.log(a)},a.prototype.info=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];console.log(a)},a.prototype.warn=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];console.warn(a)},a.prototype.error=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];console.error(a)},a}(),d=new c,a("default",d)}}}),System.register("davinci-newton/graph/AutoScale.js",["../util/AbstractSubject","../util/contains","../view/DoubleRect","../util/GenericEvent","./GraphLine","../util/removeAt","../checks/isDefined","../util/repeat","../view/SimView","../util/veryDifferent"],function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l,m,n=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b&&b.id;return{setters:[function(a){c=a},function(a){d=a},function(a){e=a},function(a){f=a},function(a){g=a},function(a){h=a},function(a){i=a},function(a){j=a},function(a){k=a},function(a){l=a}],execute:function(){m=function(a){function b(c,d,e){var f=a.call(this,c)||this;if(f.graphLines_=[],f.enabled_=!0,f.isActive_=!0,f.ownEvent_=!1,f.rangeSetX_=!1,f.rangeSetY_=!1,f.rangeXHi_=0,f.rangeXLo_=0,f.rangeYHi_=0,f.rangeYLo_=0,f.timeWindow_=10,f.extraMargin=.01,f.minSize=1e-14,f.axis_=b.BOTH_AXES,i["default"](d)&&!g["default"].isDuckType(d))throw new Error("not a GraphLine "+d);return g["default"].isDuckType(d)&&(f.graphLines_.push(d),d.addObserver(f)),f.simView_=e,e.addMemo(f),e.addObserver(f),f.lastIndex_=j["default"](-1,f.graphLines_.length),f.setComputed(f.isActive_),f}return n(b,a),b.prototype.addGraphLine=function(a){if(!g["default"].isDuckType(a))throw new Error("not a GraphLine "+a);d["default"](this.graphLines_,a)||(this.graphLines_.push(a),this.lastIndex_.push(-1))},b.prototype.clearRange=function(){this.rangeXLo_=0,this.rangeXHi_=0,this.rangeSetX_=!1,this.rangeYLo_=0,this.rangeYHi_=0,this.rangeSetY_=!1},b.prototype.getActive=function(){return this.isActive_},b.prototype.getAxis=function(){return this.axis_},b.prototype.getEnabled=function(){return this.enabled_},b.prototype.getRangeRect=function(){return new e["default"](this.rangeXLo_,this.rangeYLo_,this.rangeXHi_,this.rangeYHi_)},b.prototype.getTimeWindow=function(){return this.timeWindow_},b.prototype.memorize=function(){for(var a=0,b=this.graphLines_.length;a<b;a++){var c=this.graphLines_[a].getGraphPoints();this.lastIndex_[a]>c.getEndIndex()&&this.reset()}for(a=0,b=this.graphLines_.length;a<b;a++){c=this.graphLines_[a].getGraphPoints();for(var d=c.getIterator(this.lastIndex_[a]);d.hasNext();){var e=d.nextValue();this.updateRange_(this.graphLines_[a],e.x,e.y),this.lastIndex_[a]=d.getIndex()}}this.rangeCheck_()},b.prototype.observe=function(a){a.getSubject()===this.simView_?a.nameEquals(k["default"].SIM_RECT_CHANGED)&&(this.ownEvent_||this.setActive(!1)):d["default"](this.graphLines_,a.getSubject())&&(a.nameEquals(g["default"].PARAM_NAME_X_VARIABLE)||a.nameEquals(g["default"].PARAM_NAME_Y_VARIABLE)?this.reset():a.nameEquals(g["default"].RESET)&&this.setActive(!0))},b.prototype.rangeCheck_=function(){var a=this.minSize;if(this.rangeXHi_-this.rangeXLo_<a){var c=(this.rangeXHi_+this.rangeXLo_)/2,d=Math.max(c*a,a);this.rangeXHi_=c+d,this.rangeXLo_=c-d}if(this.rangeYHi_-this.rangeYLo_<a){var c=(this.rangeYHi_+this.rangeYLo_)/2,d=Math.max(c*a,a);this.rangeYHi_=c+d,this.rangeYLo_=c-d}var g=this.getRangeRect(),h=this.simView_.getSimRect();this.axis_===b.VERTICAL?g=new e["default"](h.getLeft(),g.getBottom(),h.getRight(),g.getTop()):this.axis_===b.HORIZONTAL&&(g=new e["default"](g.getLeft(),h.getBottom(),g.getRight(),h.getTop())),this.isActive_&&!g.nearEqual(h)&&(this.ownEvent_=!0,this.simView_.setSimRect(g),this.ownEvent_=!1,this.broadcast(new f["default"](this,b.AUTO_SCALE,g)))},b.prototype.removeGraphLine=function(a){if(!g["default"].isDuckType(a))throw new Error("not a GraphLine "+a);var b=this.graphLines_.indexOf(a);h["default"](this.graphLines_,b),h["default"](this.lastIndex_,b),this.reset()},b.prototype.reset=function(){this.clearRange();for(var a=0,b=this.lastIndex_.length;a<b;a++)this.lastIndex_[a]=-1},b.prototype.setActive=function(a){this.isActive_!==a&&(a?this.enabled_&&(this.reset(),this.simView_.addMemo(this),this.setComputed(!0),this.isActive_=!0,this.broadcast(new f["default"](this,b.ACTIVE,this.isActive_))):(this.simView_.removeMemo(this),this.setComputed(!1),this.isActive_=!1,this.broadcast(new f["default"](this,b.ACTIVE,this.isActive_))))},b.prototype.setAxis=function(a){if(a!==b.VERTICAL&&a!==b.HORIZONTAL&&a!==b.BOTH_AXES)throw new Error("unknown "+a);this.axis_=a,this.broadcastParameter(b.AXIS)},b.prototype.setComputed=function(a){var b=this,c=[k["default"].PARAM_NAME_WIDTH,k["default"].PARAM_NAME_HEIGHT,k["default"].PARAM_NAME_CENTER_X,k["default"].PARAM_NAME_CENTER_Y];c.forEach(function(c){var d=b.simView_.getParameter(c);d.setComputed(a)})},b.prototype.setEnabled=function(a){this.enabled_!==a&&(this.enabled_=a,this.setActive(a),this.broadcast(new f["default"](this,b.ENABLED,this.enabled_)))},b.prototype.setTimeWindow=function(a){l["default"](a,this.timeWindow_)&&(this.timeWindow_=a,this.reset(),this.setActive(!0),this.broadcastParameter(b.TIME_WINDOW))},b.prototype.updateRange_=function(a,b,c){isFinite(b)||(b===Number.POSITIVE_INFINITY?b=1e308:b===Number.NEGATIVE_INFINITY&&(b=-1e308)),isFinite(c)||(c===Number.POSITIVE_INFINITY?c=1e308:c===Number.NEGATIVE_INFINITY&&(c=-1e308));var d=a.getVarsList().timeIndex(),e=a.getXVariable()===d,f=a.getYVariable()===d;this.rangeSetX_?(b<this.rangeXLo_&&(e?(this.rangeXLo_=b,this.rangeXHi_=b+this.timeWindow_):this.rangeXLo_=b-this.extraMargin*(this.rangeXHi_-this.rangeXLo_)),e?b>this.rangeXHi_-this.extraMargin*this.timeWindow_&&(this.rangeXHi_=b+this.extraMargin*this.timeWindow_,this.rangeXLo_=this.rangeXHi_-this.timeWindow_):b>this.rangeXHi_&&(this.rangeXHi_=b+this.extraMargin*(this.rangeXHi_-this.rangeXLo_))):(this.rangeXLo_=b,this.rangeXHi_=b+(e?this.timeWindow_:0),this.rangeSetX_=!0),this.rangeSetY_?(c<this.rangeYLo_&&(f?(this.rangeYLo_=c,this.rangeYHi_=c+this.timeWindow_):this.rangeYLo_=c-this.extraMargin*(this.rangeYHi_-this.rangeYLo_)),f?c>this.rangeYHi_-this.extraMargin*this.timeWindow_&&(this.rangeYHi_=c+this.extraMargin*this.timeWindow_,this.rangeYLo_=this.rangeYHi_-this.timeWindow_):c>this.rangeYHi_&&(this.rangeYHi_=c+this.extraMargin*(this.rangeYHi_-this.rangeYLo_))):(this.rangeYLo_=c,this.rangeYHi_=c+(f?this.timeWindow_:0),this.rangeSetY_=!0)},b}(c["default"]),m.AXIS="AXIS",m.TIME_WINDOW="TIME_WINDOW",m.ACTIVE="ACTIVE",m.AUTO_SCALE="AUTO_SCALE",m.BOTH_AXES="BOTH_AXES",m.ENABLED="ENABLED",m.HORIZONTAL="HORIZONTAL",m.VERTICAL="VERTICAL",a("default",m)}}}),System.register("davinci-newton/util/repeat.js",[],function(a,b){"use strict";function c(a,b){for(var c=[],d=0;d<b;d++)c[d]=a;return c}b&&b.id;return a("default",c),{setters:[],execute:function(){}}}),System.register("davinci-newton/graph/DisplayGraph.js",["../util/contains","../view/DrawingMode","./GraphLine","../checks/isDefined","../checks/mustBeNonNullObject","../util/removeAt","../util/repeat","../view/ScreenRect"],function(a,b){"use strict";var c,d,e,f,g,h,i,j,k;b&&b.id;return{setters:[function(a){c=a},function(a){d=a},function(a){e=a},function(a){f=a},function(a){g=a},function(a){h=a},function(a){i=a},function(a){j=a}],execute:function(){k=function(){function a(){this.graphLines_=[],this.memDraw_=i["default"](-1,this.graphLines_.length),this.offScreen_=null,this.lastMap_=null,this.screenRect_=j["default"].EMPTY_RECT,this.needRedraw_=!1,this.useBuffer_=!1,this.zIndex=0}return a.prototype.draw=function(a,b){if(!this.screenRect_.isEmpty()){a.save(),null!=this.lastMap_&&this.lastMap_===b||(this.lastMap_=b,this.needRedraw_=!0);for(var c=0,d=this.graphLines_.length;c<d;c++)if(this.memDraw_[c]>this.graphLines_[c].getGraphPoints().getEndIndex()){this.reset();break}if(this.useBuffer_){var e=this.screenRect_.getWidth(),f=this.screenRect_.getHeight();null==this.offScreen_&&(this.offScreen_=document.createElement("canvas"),this.offScreen_.width=e,this.offScreen_.height=f,this.needRedraw_=!0);var g=this.offScreen_.getContext("2d");this.needRedraw_?(g.clearRect(0,0,e,f),this.fullDraw(g,b),this.needRedraw_=!1):this.incrementalDraw(g,b),a.drawImage(this.offScreen_,0,0,e,f)}else this.needRedraw_=!0,this.needRedraw_?(this.fullDraw(a,b),this.needRedraw_=!1):this.incrementalDraw(a,b);for(var c=0,d=this.graphLines_.length;c<d;c++)this.drawHotSpot(a,b,this.graphLines_[c]);a.restore()}},a.prototype.drawHotSpot=function(a,b,c){var d=c.getGraphPoints().getEndValue();if(null!=d){var e=b.simToScreenX(d.x),f=b.simToScreenY(d.y),g=c.getHotSpotColor();g&&(a.fillStyle=g,a.fillRect(e-2,f-2,5,5))}},a.prototype.drawPoints=function(a,b,c,e){var f=b.screenToSimRect(this.screenRect_),h=e.getGraphPoints().getIterator(c);if(!h.hasNext())return c;var i=h.nextValue();g["default"]("first",i);var j=e.getGraphStyle(h.getIndex());if(j.drawMode===d["default"].DOTS){var k=b.simToScreenX(i.x),l=b.simToScreenY(i.y),m=j.lineWidth;a.fillStyle=j.color_,a.fillRect(k,l,m,m)}for(;h.hasNext();){var n=i;if(i=h.nextValue(),g["default"]("next",i),i.x!==n.x||i.y!==n.y){var o=e.getGraphStyle(h.getIndex()),p=i.seqX===n.seqX&&i.seqY===n.seqY;if(o.drawMode!==d["default"].DOTS&&p){if(!f.maybeVisible(n,i))continue;var q=b.simToScreenX(n.x),r=b.simToScreenY(n.y),s=b.simToScreenX(i.x),t=b.simToScreenY(i.y);a.strokeStyle=o.color_,a.lineWidth=o.lineWidth,a.beginPath(),a.moveTo(q,r),a.lineTo(s,t),a.stroke()}else{if(!f.contains(i))continue;var k=b.simToScreenX(i.x),l=b.simToScreenY(i.y),m=o.lineWidth;a.fillStyle=o.color_,a.fillRect(k,l,m,m)}}}return h.getIndex()},a.prototype.fullDraw=function(a,b){this.memDraw_=i["default"](-1,this.graphLines_.length),this.incrementalDraw(a,b)},a.prototype.getZIndex=function(){return this.zIndex},a.prototype.setZIndex=function(a){this.zIndex=f["default"](a)?a:0},a.prototype.incrementalDraw=function(a,b){for(var c=0,d=this.graphLines_.length;c<d;c++)this.memDraw_[c]=this.drawPoints(a,b,this.memDraw_[c],this.graphLines_[c])},a.prototype.isDragable=function(){return!1},a.prototype.addGraphLine=function(a){if(!e["default"].isDuckType(a))throw new Error("not a GraphLine "+a);c["default"](this.graphLines_,a)||(this.graphLines_.push(a),this.memDraw_.push(-1))},a.prototype.removeGraphLine=function(a){if(!e["default"].isDuckType(a))throw new Error("not a GraphLine "+a);var b=this.graphLines_.indexOf(a);h["default"](this.graphLines_,b),h["default"](this.memDraw_,b),this.needRedraw_=!0},a.prototype.setDragable=function(a){},a.prototype.setScreenRect=function(a){this.screenRect_=a,this.offScreen_=null},a.prototype.setUseBuffer=function(a){this.useBuffer_=a,this.useBuffer_||(this.offScreen_=null)},a.prototype.reset=function(){this.memDraw_=i["default"](-1,this.graphLines_.length),this.needRedraw_=!0},a}(),a("default",k)}}}),System.register("davinci-newton/util/UtilityCore.js",[],function(a,b){"use strict";var c;b&&b.id;return{setters:[],execute:function(){c=function(){function a(){}return a}(),c.MAX_INTEGER=Math.pow(2,53),a("default",c)}}}),System.register("davinci-newton/util/CircularList.js",["./UtilityCore"],function(a,b){"use strict";var c,d,e,f;b&&b.id;return{setters:[function(a){c=a}],execute:function(){d="exceeded max int",e=function(){function a(a){if(void 0===a&&(a=3e3),this.size_=0,this.cycles_=0,this.nextPtr_=0,this.lastPtr_=-1,this.capacity_=a||3e3,this.capacity_<2)throw new Error;this.size_=0,this.cycles_=0,this.nextPtr_=0,this.lastPtr_=-1,this.values_=new Array(this.capacity_),this.lastValue_=null}return a.prototype.causeMaxIntError=function(){this.size_=this.capacity_,this.cycles_=Math.floor(c["default"].MAX_INTEGER/this.capacity_)-1},a.prototype.getEndIndex=function(){if(0===this.size_)return-1;var a;return a=0===this.nextPtr_?this.pointerToIndex(this.size_-1):this.pointerToIndex(this.nextPtr_-1)},a.prototype.getEndValue=function(){var a=this.getEndIndex();return a===-1?null:this.values_[this.indexToPointer_(a)]},a.prototype.getIterator=function(a){return new f(this,a)},a.prototype.getSize=function(){return this.size_},a.prototype.getStartIndex=function(){var a=this.size_<this.capacity_?0:this.pointerToIndex(this.nextPtr_);return a},a.prototype.getValue=function(a){var b=this.indexToPointer_(a);return this.values_[b]},a.prototype.indexToPointer_=function(a){if(this.size_<this.capacity_)return a;var b=a%this.capacity_,c=a-(this.cycles_-(b<this.nextPtr_?0:1))*this.capacity_;return c},a.prototype.pointerToIndex=function(a){if(this.size_<this.capacity_)return a;var b=a+(this.cycles_-(a<this.nextPtr_?0:1))*this.capacity_;if(b>=c["default"].MAX_INTEGER)throw new Error(d);return b},a.prototype.reset=function(){this.nextPtr_=this.size_=0,this.cycles_=0,this.lastPtr_=-1},a.prototype.store=function(a){return this.lastPtr_=this.nextPtr_,this.values_[this.nextPtr_]=a,this.nextPtr_++,this.size_<this.capacity_&&this.size_++,this.nextPtr_>=this.capacity_&&(this.cycles_++,this.nextPtr_=0),this.pointerToIndex(this.lastPtr_)},a}(),a("default",e),f=function(){function a(a,b){if(this.cList=a,this.first_=a.size_>0,this.cList_=a,(void 0===b||b<0)&&(b=a.getStartIndex()),a.size_>0&&(b<a.getStartIndex()||b>a.getEndIndex()))throw new Error("out of range startIndex="+b);this.index_=b,this.pointer_=a.indexToPointer_(b)}return a.prototype.getIndex=function(){if(0===this.cList_.size_)throw new Error("no data");return this.index_},a.prototype.getValue=function(){if(0===this.cList_.size_)throw new Error("no data");return this.cList_.values_[this.pointer_]},a.prototype.hasNext=function(){return this.first_||this.index_<this.cList_.getEndIndex()},a.prototype.hasPrevious=function(){return this.first_||this.index_>this.cList_.getStartIndex()},a.prototype.nextValue=function(){if(0===this.cList_.size_)throw new Error("no data");if(this.first_)this.first_=!1;else{if(this.index_+1>this.cList_.getEndIndex())throw new Error("cannot iterate past end of list");this.index_++,this.pointer_=this.cList_.indexToPointer_(this.index_)}return this.cList_.values_[this.pointer_]},a.prototype.previousValue=function(){if(0===this.cList_.size_)throw new Error("no data");if(this.first_)this.first_=!1;else{if(this.index_-1<this.cList_.getStartIndex())throw new Error("cannot iterate prior to start of list");this.index_--,this.pointer_=this.cList_.indexToPointer_(this.index_)}return this.cList_.values_[this.pointer_]},a}()}}}),System.register("davinci-newton/view/DrawingMode.js",[],function(a,b){"use strict";var c;b&&b.id;return{setters:[],execute:function(){c=function(){function a(){}return a}(),c.DOTS="dots",c.LINES="lines",a("default",c)}}}),System.register("davinci-newton/graph/GraphPoint.js",[],function(a,b){"use strict";var c;b&&b.id;return{setters:[],execute:function(){c=function(){function a(a,b,c,d){this.x=a,this.y=b,this.seqX=c,this.seqY=d}return a.prototype.equals=function(a){return this.x===a.x&&this.y===a.y&&this.seqX===a.seqX&&this.seqY===a.seqY},a}(),a("default",c)}}}),System.register("davinci-newton/graph/GraphStyle.js",[],function(a,b){"use strict";var c;b&&b.id;return{setters:[],execute:function(){c=function(){function a(a,b,c,d){this.index_=a,this.drawMode=b,this.color_=c,this.lineWidth=d}return a}(),a("default",c)}}}),System.register("davinci-newton/checks/isLE.js",[],function(a,b){"use strict";function c(a,b){return a<=b}b&&b.id;return a("default",c),{setters:[],execute:function(){}}}),System.register("davinci-newton/checks/mustBeLE.js",["../checks/mustSatisfy","../checks/isLE"],function(a,b){"use strict";function c(a,b,c,f){return d["default"](a,e["default"](b,c),function(){return"be less than or equal to "+c},f),b}b&&b.id;a("default",c);var d,e;return{setters:[function(a){d=a},function(a){e=a}],execute:function(){}}}),System.register("davinci-newton/checks/mustBeObject.js",["../checks/mustSatisfy","../checks/isObject"],function(a,b){"use strict";function c(){return"be an `object`"}function d(a,b,d){return e["default"](a,f["default"](b),c,d),b}b&&b.id;a("default",d);var e,f;return{setters:[function(a){e=a},function(a){f=a}],execute:function(){}}}),System.register("davinci-newton/util/ParameterString.js",["./toName","./validName"],function(a,b){"use strict";var c,d,e;b&&b.id;return{setters:[function(a){c=a},function(a){d=a}],execute:function(){e=function(){function a(a,b,e,f,g,h){this.subject_=a,this.name_=d["default"](c["default"](b)),this.getter_=e,this.setter_=f,this.isComputed_=!1,this.suggestedLength_=20,this.maxLength_=Number.POSITIVE_INFINITY,this.choices_=[],this.values_=[],this.inputFunction_=null}return a.prototype.getName=function(){return this.name_},a.prototype.getSubject=function(){return this.subject_},a.prototype.getValue=function(){return this.getter_()},a.prototype.nameEquals=function(a){return this.name_===c["default"](a)},a.prototype.setComputed=function(a){this.isComputed_=a},a}(),a("ParameterString",e),a("default",e)}}}),System.register("davinci-newton/graph/GraphLine.js",["../util/AbstractSubject","../util/CircularList","../view/DrawingMode","../util/GenericEvent","./GraphPoint","./GraphStyle","../checks/isObject","../checks/mustBeLE","../checks/mustBeObject","../util/ParameterNumber","../util/ParameterString","../util/veryDifferent"],function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l,m,n,o,p=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b&&b.id;return{setters:[function(a){c=a},function(a){d=a},function(a){e=a},function(a){f=a},function(a){g=a},function(a){h=a},function(a){i=a},function(a){j=a},function(a){k=a},function(a){l=a},function(a){m=a},function(a){n=a}],execute:function(){o=function(a){function b(c,f,g){var h=a.call(this,c)||this;return h.lineWidth_=1,h.hotSpotColor_="red",h.styles_=[],h.varsList_=f,f.addObserver(h),h.xVar_=-1,h.yVar_=-1,h.xVarParam_=new l["default"](h,b.PARAM_NAME_X_VARIABLE,function(){return h.getXVariable()},function(a){return h.setXVariable(a)}),h.xVarParam_.setLowerLimit(-1),h.addParameter(h.xVarParam_),h.yVarParam_=new l["default"](h,b.PARAM_NAME_Y_VARIABLE,function(){return h.getYVariable()},function(a){return h.setYVariable(a)}),h.yVarParam_.setLowerLimit(-1),h.addParameter(h.yVarParam_),h.dataPoints_=new d["default"](g||1e5),h.drawColor_="lime",h.drawMode_=e["default"].LINES,h.addGraphStyle(),h.xTransform=function(a,b){return a},h.yTransform=function(a,b){return b},h.addParameter(new l["default"](h,b.PARAM_NAME_LINE_WIDTH,function(){return h.getLineWidth()},function(a){return h.setLineWidth(a)})),h.addParameter(new m["default"](h,b.PARAM_NAME_DRAWING_MODE,function(){return h.getDrawingMode()},function(a){return h.setDrawingMode(a)})),h.addParameter(new m["default"](h,b.PARAM_NAME_COLOR,function(){return h.getColor()},function(a){return h.setColor(a)})),h}return p(b,a),b.prototype.addGraphStyle=function(){this.styles_.push(new h["default"](this.dataPoints_.getEndIndex()+1,this.drawMode_,this.drawColor_,this.lineWidth_))},b.isDuckType=function(a){return a instanceof b||i["default"](a)&&void 0!==a.setXVariable&&void 0!==a.setYVariable&&void 0!==a.setColor&&void 0!==a.setLineWidth&&void 0!==a.setAxes&&void 0!==a.getVarsList&&void 0!==a.reset&&void 0!==a.getGraphStyle},b.prototype.getColor=function(){return this.drawColor_},b.prototype.getDrawingMode=function(){return this.drawMode_},b.prototype.getGraphPoints=function(){return this.dataPoints_},b.prototype.getGraphStyle=function(a){var b=this.styles_;if(0===b.length)throw new Error("graph styles list is empty");for(var c=b[0],d=1,e=b.length;d<e;d++){var f=b[d];if(j["default"]("",c.index_,f.index_),f.index_>a)break;c=f}return k["default"]("last",c),c},b.prototype.getHotSpotColor=function(){return this.hotSpotColor_},b.prototype.getLineWidth=function(){return this.lineWidth_},b.prototype.getVarsList=function(){return this.varsList_},b.prototype.getXVariable=function(){return this.xVar_},b.prototype.getXVarName=function(){return this.xVar_>-1?this.varsList_.getVariable(this.xVar_).getName():""},b.prototype.getYVariable=function(){return this.yVar_},b.prototype.getYVarName=function(){return this.yVar_>-1?this.varsList_.getVariable(this.yVar_).getName():""},b.prototype.memorize=function(){if(this.xVar_>-1&&this.yVar_>-1){var a=this.varsList_.getVariable(this.xVar_),b=this.varsList_.getVariable(this.yVar_),c=a.getValue(),d=b.getValue(),e=this.xTransform(c,d),f=this.yTransform(c,d),h=a.getSequence(),i=b.getSequence(),j=new g["default"](e,f,h,i),k=this.dataPoints_.getEndValue();null!=k&&k.equals(j)||this.dataPoints_.store(j)}},b.prototype.observe=function(a){},b.prototype.reset=function(){this.dataPoints_.reset(),this.resetStyle(),this.broadcast(new f["default"](this,b.RESET))},b.prototype.resetStyle=function(){this.styles_=[],this.addGraphStyle()},b.prototype.setColor=function(a){this.drawColor_!==a&&(this.drawColor_=a,this.addGraphStyle(),this.broadcastParameter(b.PARAM_NAME_COLOR))},b.prototype.setDrawingMode=function(a){this.drawMode_!==a&&(this.drawMode_=a,this.addGraphStyle()),this.broadcastParameter(b.PARAM_NAME_DRAWING_MODE)},b.prototype.setHotSpotColor=function(a){this.hotSpotColor_=a},b.prototype.setLineWidth=function(a){n["default"](a,this.lineWidth_)&&(this.lineWidth_=a,this.addGraphStyle(),this.broadcastParameter(b.PARAM_NAME_LINE_WIDTH))},b.prototype.setXVariable=function(a){if(a<-1||a>this.varsList_.numVariables()-1)throw new Error("setXVariable bad index "+a);a!==this.xVar_&&(this.xVar_=a,this.reset(),this.broadcastParameter(b.PARAM_NAME_X_VARIABLE))},b.prototype.setYVariable=function(a){if(a<-1||a>this.varsList_.numVariables()-1)throw new Error("setYVariable bad index "+a);a!==this.yVar_&&(this.yVar_=a,this.reset(),this.broadcastParameter(b.PARAM_NAME_Y_VARIABLE))},b}(c["default"]),o.PARAM_NAME_X_VARIABLE="X variable",o.PARAM_NAME_Y_VARIABLE="Y variable",o.PARAM_NAME_LINE_WIDTH="line width",o.PARAM_NAME_COLOR="color",o.PARAM_NAME_DRAWING_MODE="drawing mode",o.RESET="RESET",a("default",o)}}}),System.register("davinci-newton/graph/Graph.js",["../util/AbstractSubject","./AutoScale","./DisplayGraph","../view/DoubleRect","./GraphLine","../view/HorizAlign","../view/LabCanvas","../view/SimView","../view/VerticalAlign"],function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l,m=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b&&b.id;return{setters:[function(a){c=a},function(a){d=a},function(a){e=a},function(a){f=a},function(a){g=a},function(a){h=a},function(a){i=a},function(a){j=a},function(a){k=a}],execute:function(){l=function(a){function b(b,c){var d=a.call(this,"TIME_GRAPH_LAYOUT")||this;d.varsList=c,d.view=new j["default"]("TIME_GRAPH_VIEW",new f["default"](0,0,1,1));var g=document.getElementById(b);return d.labCanvas=new i["default"](g,"GRAPH_CANVAS"),d.view.setHorizAlign(h["default"].FULL),d.view.setVerticalAlign(k["default"].FULL),d.labCanvas.addView(d.view),d.displayGraph=new e["default"],d.displayGraph.setScreenRect(d.view.getScreenRect()),d.view.getDisplayList().prepend(d.displayGraph),d.timeIdx_=c.timeIndex(),d}return m(b,a),b.prototype.addTrace=function(a){var b=new g["default"](a,this.varsList);return this.view.addMemo(b),b.setColor("black"),this.displayGraph.addGraphLine(b),this.displayGraph.setUseBuffer(b.getXVariable()!==this.timeIdx_),b},b.prototype.memorize=function(){this.labCanvas.memorize()},b.prototype.render=function(){this.labCanvas.paint()},b.prototype.setAutoScale=function(a){this.autoScale=new d["default"]("TIME_GRAPH_AUTO_SCALE",a,this.view),this.autoScale.extraMargin=.05},b}(c["default"]),a("Graph",l),a("default",l)}}}),System.register("davinci-newton/util/isEmpty.js",[],function(a,b){"use strict";function c(a){return 0===a.length}b&&b.id;return a("default",c),{setters:[],execute:function(){}}}),System.register("davinci-newton/view/LabCanvas.js",["../util/AbstractSubject","../util/clone","../util/contains","../util/GenericEvent","../util/isEmpty","../checks/isNumber","../checks/mustBeNonNullObject","../util/remove","./ScreenRect","../util/veryDifferent"],function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b&&b.id;return{setters:[function(a){c=a},function(a){d=a},function(a){e=a},function(a){f=a},function(a){g=a},function(a){h=a},function(a){i=a},function(a){j=a},function(a){k=a},function(a){l=a}],execute:function(){m="width",n="height",o="alpha",p="background",q=function(a){function b(b,c){var d=a.call(this,c)||this;return d.labViews_=[],d.memorizables_=[],d.focusView_=null,d.alpha_=1,d.background_="",d.canvas_=b,b.contentEditable="false",d}return r(b,a),b.prototype.addMemo=function(a){e["default"](this.memorizables_,a)||this.memorizables_.push(a)},b.prototype.addView=function(a){if(i["default"]("view",a),this.getWidth()>0&&this.getHeight()>0){var c=new k["default"](0,0,this.getWidth(),this.getHeight());a.setScreenRect(c)}this.labViews_.push(a),this.addMemo(a),this.broadcast(new f["default"](this,b.VIEW_ADDED,a)),this.broadcast(new f["default"](this,b.VIEW_LIST_MODIFIED)),null==this.focusView_&&this.setFocusView(a)},b.prototype.focus=function(){this.canvas_.focus()},b.prototype.getAlpha=function(){return this.alpha_},b.prototype.getBackground=function(){return this.background_},b.prototype.getCanvas=function(){return this.canvas_},b.prototype.getContext=function(){return this.canvas_.getContext("2d")},b.prototype.getFocusView=function(){return this.focusView_},b.prototype.getHeight=function(){return this.canvas_.height},b.prototype.getMemos=function(){return d["default"](this.memorizables_)},b.prototype.getScreenRect=function(){return new k["default"](0,0,this.canvas_.width,this.canvas_.height)},b.prototype.getViews=function(){return d["default"](this.labViews_)},b.prototype.getWidth=function(){return this.canvas_.width},b.prototype.memorize=function(){for(var a=0,b=this.memorizables_.length;a<b;a++)this.memorizables_[a].memorize()},b.prototype.notifySizeChanged=function(){var a=this.getScreenRect();this.labViews_.forEach(function(b){b.setScreenRect(a)}),this.broadcast(new f["default"](this,b.SIZE_CHANGED))},b.prototype.paint=function(){if(null!=this.canvas_.offsetParent){var a=this.canvas_.getContext("2d");a.save(),""!==this.background_?(a.globalAlpha=this.alpha_,a.fillStyle=this.background_,a.fillRect(0,0,this.canvas_.width,this.canvas_.height),a.globalAlpha=1):a.clearRect(0,0,this.canvas_.width,this.canvas_.height);for(var b=this.labViews_,c=b.length,d=0;d<c;d++)b[d].paint(a);a.restore()}},b.prototype.removeMemo=function(a){j["default"](this.memorizables_,a)},b.prototype.removeView=function(a){i["default"]("view",a),j["default"](this.labViews_,a),this.removeMemo(a),this.focusView_===a&&this.setFocusView(g["default"](this.labViews_)?null:this.labViews_[0]),this.broadcast(new f["default"](this,b.VIEW_REMOVED,a)),this.broadcast(new f["default"](this,b.VIEW_LIST_MODIFIED))},b.prototype.setAlpha=function(a){l["default"](this.alpha_,a)&&(this.alpha_=a,l["default"](a,1)&&""===this.background_&&this.setBackground("white"),this.broadcastParameter(o))},b.prototype.setBackground=function(a){this.background_!==a&&(this.background_=a,this.broadcastParameter(p))},b.prototype.setFocusView=function(a){if(null!=a&&!e["default"](this.labViews_,a))throw new Error("cannot set focus to unknown view "+a);this.focusView_!==a&&(null!=this.focusView_&&this.focusView_.loseFocus(),this.focusView_=a,null!=a&&a.gainFocus(),this.broadcast(new f["default"](this,b.FOCUS_VIEW_CHANGED,a)))},b.prototype.setHeight=function(a){l["default"](a,this.canvas_.height)&&(this.canvas_.height=a),this.notifySizeChanged(),this.broadcastParameter(n)},b.prototype.setScreenRect=function(a){if(!k["default"].isDuckType(a))throw new Error("not a ScreenRect "+a);if(0!==a.getTop()||0!==a.getLeft())throw new Error("top left must be 0,0, was: "+a);this.setSize(a.getWidth(),a.getHeight())},b.prototype.setSize=function(a,b){if(!h["default"](a)||a<=0||!h["default"](b)||b<=0)throw new Error("bad size "+a+", "+b);this.canvas_.width=a,this.canvas_.height=b,this.notifySizeChanged(),this.broadcastParameter(m),this.broadcastParameter(n)},b.prototype.setWidth=function(a){l["default"](a,this.canvas_.width)&&(this.canvas_.width=a),this.notifySizeChanged(),this.broadcastParameter(m)},b}(c["default"]),q.FOCUS_VIEW_CHANGED="FOCUS_VIEW_CHANGED",q.SIZE_CHANGED="SIZE_CHANGED",q.VIEW_LIST_MODIFIED="VIEW_LIST_MODIFIED",q.VIEW_ADDED="VIEW_ADDED",q.VIEW_REMOVED="VIEW_REMOVED",a("LabCanvas",q),a("default",q)}}}),System.register("davinci-newton/checks/isDefined.js",[],function(a,b){"use strict";function c(a){return"undefined"!=typeof a}b&&b.id;return a("default",c),{setters:[],execute:function(){}}}),System.register("davinci-newton/checks/mustBeDefined.js",["../checks/mustSatisfy","../checks/isDefined"],function(a,b){"use strict";function c(){return"not be 'undefined'"}function d(a,b,d){return e["default"](a,f["default"](b),c,d),b}b&&b.id;a("default",d);var e,f;return{setters:[function(a){e=a},function(a){f=a}],execute:function(){}}}),System.register("davinci-newton/checks/isInteger.js",["../checks/isNumber"],function(a,b){"use strict";function c(a){return d["default"](a)&&a%1===0}b&&b.id;a("default",c);var d;return{setters:[function(a){d=a}],execute:function(){}}}),System.register("davinci-newton/checks/mustBeInteger.js",["../checks/mustSatisfy","../checks/isInteger"],function(a,b){"use strict";function c(){return"be an integer"}function d(a,b,d){return e["default"](a,f["default"](b),c,d),b}b&&b.id;a("default",d);var e,f;return{setters:[function(a){e=a},function(a){f=a}],execute:function(){}}}),System.register("davinci-newton/checks/isUndefined.js",[],function(a,b){"use strict";function c(a){return"undefined"==typeof a}b&&b.id;return a("default",c),{setters:[],execute:function(){}}}),System.register("davinci-newton/checks/mustBeNumber.js",["../checks/mustSatisfy","../checks/isNumber"],function(a,b){"use strict";function c(){return"be a `number`"}function d(a,b,d){return e["default"](a,f["default"](b),c,d),b}b&&b.id;a("default",d);var e,f;return{setters:[function(a){e=a},function(a){f=a}],execute:function(){}}}),System.register("davinci-newton/checks/expectArg.js",["../checks/isUndefined","../checks/mustBeNumber"],function(a,b){"use strict";function c(a,b){return e["default"](b)?a:b()}function d(a,b){var d={toSatisfy:function(a,b){if(e["default"](a))throw new Error("condition must be specified");if(e["default"](b))throw new Error("message must be specified");if(!a)throw new Error(b);return d},toBeBoolean:function(e){var f=typeof b;if("boolean"!==f)throw new Error(c("Expecting argument "+a+": "+f+" to be a boolean.",e));return d},toBeDefined:function(){var c=typeof b;if("undefined"===c){var e="Expecting argument "+a+": "+c+" to be defined.";throw new Error(e)}return d},toBeInClosedInterval:function(c,e){var g=b,h=g;if(f["default"]("x",h),h>=c&&h<=e)return d;var i="Expecting argument "+a+" => "+b+" to be in the range ["+c+", "+e+"].";throw new Error(i)},toBeFunction:function(){var c=typeof b;if("function"!==c){var e="Expecting argument "+a+": "+c+" to be a function.";throw new Error(e)}return d},toBeNumber:function(e){var f=typeof b;if("number"!==f)throw new Error(c("Expecting argument "+a+": "+f+" to be a number.",e));return d},toBeObject:function(e){var f=typeof b;if("object"!==f)throw new Error(c("Expecting argument "+a+": "+f+" to be an object.",e));
return d},toBeString:function(){var c=typeof b;if("string"!==c){var e="Expecting argument "+a+": "+c+" to be a string.";throw new Error(e)}return d},toBeUndefined:function(){var c=typeof b;if("undefined"!==c){var e="Expecting argument "+a+": "+c+" to be undefined.";throw new Error(e)}return d},toNotBeNull:function(){if(null===b){var c="Expecting argument "+a+" to not be null.";throw new Error(c)}return d},get value(){return b}};return d}b&&b.id;a("default",d);var e,f;return{setters:[function(a){e=a},function(a){f=a}],execute:function(){}}}),System.register("davinci-newton/math/AbstractMatrix.js",["../checks/mustBeDefined","../checks/mustBeInteger","../checks/expectArg"],function(a,b){"use strict";var c,d,e,f;b&&b.id;return{setters:[function(a){c=a},function(a){d=a},function(a){e=a}],execute:function(){f=function(){function a(a,b){this._elements=c["default"]("elements",a),this._dimensions=d["default"]("dimensions",b),this._length=b*b,e["default"]("elements",a).toSatisfy(a.length===this._length,"elements must have length "+this._length),this.modified=!1}return Object.defineProperty(a.prototype,"dimensions",{get:function(){return this._dimensions},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"elements",{get:function(){return this._elements},set:function(a){e["default"]("elements",a).toSatisfy(a.length===this._length,"elements length must be "+this._length),this._elements=a},enumerable:!0,configurable:!0}),a.prototype.copy=function(a){return this.elements.set(a.elements),this},a.prototype.getElement=function(a,b){return this.elements[a+b*this._dimensions]},a.prototype.isOne=function(){for(var a=0;a<this._dimensions;a++)for(var b=0;b<this._dimensions;b++){var c=this.getElement(a,b);if(a===b){if(1!==c)return!1}else if(0!==c)return!1}return!0},a.prototype.setElement=function(a,b,c){this.elements[a+b*this._dimensions]=c},a}(),a("default",f)}}}),System.register("davinci-newton/math/Matrix3.js",["./AbstractMatrix"],function(a,b){"use strict";var c,d,e=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b&&b.id;return{setters:[function(a){c=a}],execute:function(){d=function(a){function b(b){return a.call(this,b,3)||this}return e(b,a),b.prototype.rotation=function(a){var b=-a.yz,c=-a.zx,d=-a.xy,e=a.a,f=b+b,g=c+c,h=d+d,i=b*f,j=b*g,k=b*h,l=c*g,m=c*h,n=d*h,o=e*f,p=e*g,q=e*h;return this.set(1-l-n,j-q,k+p,j+q,1-i-n,m-o,k-p,m+o,1-i-l),this},b.prototype.set=function(a,b,c,d,e,f,g,h,i){var j=this.elements;return j[0]=a,j[3]=b,j[6]=c,j[1]=d,j[4]=e,j[7]=f,j[2]=g,j[5]=h,j[8]=i,this},b.one=function(){return new b(new Float32Array([1,0,0,0,1,0,0,0,1]))},b}(c["default"]),a("Matrix3",d),a("default",d)}}}),System.register("davinci-newton/math/Spinor3.js",[],function(a,b){"use strict";var c;b&&b.id;return{setters:[],execute:function(){c=function(){function a(a,b,c,d){void 0===a&&(a=1),void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=0),this.a=a,this.xy=b,this.yz=c,this.zx=d}return a.prototype.copy=function(a){return this.a=a.a,this.xy=a.xy,this.yz=a.yz,this.zx=a.zx,this},a.prototype.one=function(){return this.a=1,this.xy=0,this.yz=0,this.zx=0,this},a}(),a("Spinor3",c),a("default",c)}}}),System.register("davinci-newton/math/Vector3.js",[],function(a,b){"use strict";var c;b&&b.id;return{setters:[],execute:function(){c=function(){function a(a,b,c){void 0===a&&(a=0),void 0===b&&(b=0),void 0===c&&(c=0),this.x=a,this.y=b,this.z=c}return a.prototype.applyMatrix=function(a){var b=this.x,c=this.y,d=this.z,e=a.elements;return this.x=e[0]*b+e[3]*c+e[6]*d,this.y=e[1]*b+e[4]*c+e[7]*d,this.z=e[2]*b+e[5]*c+e[8]*d,this},a.prototype.copy=function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this},a.prototype.dual=function(a){return this.x=-a.yz,this.y=-a.zx,this.z=-a.xy,this},a.prototype.divByScalar=function(a){return this.x/=a,this.y/=a,this.z/=a,this},a.prototype.mulByScalar=function(a){return this.x*=a,this.y*=a,this.z*=a,this},a.prototype.neg=function(){return this.mulByScalar(-1)},a.dual=function(b){return(new a).dual(b)},a}(),a("Vector3",c),a("default",c)}}}),System.register("davinci-newton/engine/RigidBody.js",["../objects/AbstractSimObject","../math/Bivector3","../math/Matrix3","../math/Spinor3","../math/Vector","../math/Vector3"],function(a,b){"use strict";var c,d,e,f,g,h,i,j=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b&&b.id;return{setters:[function(a){c=a},function(a){d=a},function(a){e=a},function(a){f=a},function(a){g=a},function(a){h=a}],execute:function(){i=function(a){function b(b){var c=a.call(this,b)||this;return c.mass_=1,c.Ibody=e["default"].one(),c.Ibodyinv=e["default"].one(),c.varsIndex_=-1,c.position_=new h["default"],c.attitude_=new f["default"],c.linearMomentum_=new h["default"],c.angularMomentum_=new d["default"],c.V=new h["default"],c.Iinv=e["default"].one(),c.ω=new h["default"],c.Ω=new d["default"],c.cm_body_=g["default"].ORIGIN,c}return j(b,a),Object.defineProperty(b.prototype,"X",{get:function(){return this.position_},set:function(a){this.position_.copy(a)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"R",{get:function(){return this.attitude_},set:function(a){this.attitude_.copy(a)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"P",{get:function(){return this.linearMomentum_},set:function(a){this.linearMomentum_.copy(a)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"L",{get:function(){return this.angularMomentum_},set:function(a){this.angularMomentum_.copy(a)},enumerable:!0,configurable:!0}),b.prototype.getExpireTime=function(){return Number.POSITIVE_INFINITY},b.prototype.getVarsIndex=function(){return this.varsIndex_},b.prototype.setVarsIndex=function(a){this.varsIndex_=a},Object.defineProperty(b.prototype,"M",{get:function(){return this.mass_},set:function(a){this.mass_=a},enumerable:!0,configurable:!0}),b.prototype.momentAboutCM=function(){return 1},b.prototype.rotationalEnergy=function(){return 0},b.prototype.translationalEnergy=function(){return 0},b.prototype.bodyToWorld=function(a){var b=g["default"].fromVector(a).subtract(this.cm_body_);return b.rotate(this.R).add(this.X)},b.prototype.worldVelocityOfBodyPoint=function(a){var b=this.rotateBodyToWorld(g["default"].fromVector(a).subtract(this.cm_body_));return g["default"].fromVector(this.ω).cross(b).add(this.V)},b.prototype.rotateBodyToWorld=function(a){return g["default"].fromVector(a).rotate(this.R)},b}(c["default"]),a("RigidBody",i),a("default",i)}}}),System.register("davinci-newton/model/EnergyInfo.js",[],function(a,b){"use strict";var c;b&&b.id;return{setters:[],execute:function(){c=function(){function a(a,b,c){}return a.prototype.getPotential=function(){return 0},a.prototype.getTranslational=function(){return 0},a.prototype.getRotational=function(){return 0},a.prototype.getTotalEnergy=function(){return 0},a}(),a("EnergyInfo",c),a("default",c)}}}),System.register("davinci-newton/checks/mustSatisfy.js",[],function(a,b){"use strict";function c(a,b,c,d){if(!b){var e=c?c():"satisfy some condition",f=d?" in "+d():"";throw new Error(a+" must "+e+f+".")}}b&&b.id;return a("default",c),{setters:[],execute:function(){}}}),System.register("davinci-newton/checks/isNull.js",[],function(a,b){"use strict";function c(a){return null===a}b&&b.id;return a("default",c),{setters:[],execute:function(){}}}),System.register("davinci-newton/checks/mustBeNonNullObject.js",["../checks/mustSatisfy","../checks/isNull","../checks/isObject"],function(a,b){"use strict";function c(){return"be a non-null `object`"}function d(a,b,d){return e["default"](a,g["default"](b)&&!f["default"](b),c,d),b}b&&b.id;a("default",d);var e,f,g;return{setters:[function(a){e=a},function(a){f=a},function(a){g=a}],execute:function(){}}}),System.register("davinci-newton/core/SimList.js",["../util/AbstractSubject","../util/contains","../util/GenericEvent","../checks/mustBeNonNullObject"],function(a,b){"use strict";var c,d,e,f,g,h=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b&&b.id;return{setters:[function(a){c=a},function(a){d=a},function(a){e=a},function(a){f=a}],execute:function(){g=function(a){function b(){var b=a.call(this,"SIM_LIST")||this;return b.elements_=[],b}return h(b,a),b.prototype.add=function(a){for(var c=0;c<arguments.length;c++){var g=arguments[c];f["default"]("element",g),d["default"](this.elements_,g)||(this.elements_.push(g),this.broadcast(new e["default"](this,b.OBJECT_ADDED,g)))}},b.prototype.forEach=function(a){return this.elements_.forEach(a)},b.prototype.remove=function(a){throw new Error("TODO")},b.prototype.removeTemporary=function(a){for(var c=this.elements_.length-1;c>=0;c--){var d=this.elements_[c];d.getExpireTime()<a&&(this.elements_.splice(c,1),this.broadcast(new e["default"](this,b.OBJECT_REMOVED,d)))}},b}(c["default"]),g.OBJECT_ADDED="OBJECT_ADDED",g.OBJECT_REMOVED="OBJECT_REMOVED",a("SimList",g),a("default",g)}}}),System.register("davinci-newton/model/ConcreteVariable.js",["../util/toName","../util/validName"],function(a,b){"use strict";var c,d,e;b&&b.id;return{setters:[function(a){c=a},function(a){d=a}],execute:function(){e=function(){function a(a,b,e){this.varsList_=a,this.localName_=e,this.value_=0,this.seq_=0,this.isComputed_=!1,this.doesBroadcast_=!1,this.name_=d["default"](c["default"](b))}return a.prototype.getBroadcast=function(){return this.doesBroadcast_},a.prototype.getName=function(a){return a?this.localName_:this.name_},a.prototype.getSequence=function(){return this.seq_},a.prototype.getSubject=function(){return this.varsList_},a.prototype.getValue=function(){return this.value_},a.prototype.nameEquals=function(a){return this.name_===c["default"](a)},a.prototype.setBroadcast=function(a){this.doesBroadcast_=a},a.prototype.setComputed=function(a){this.isComputed_=a},a.prototype.setValue=function(a){this.value_!==a&&(this.value_=a,this.seq_++,this.doesBroadcast_&&this.varsList_.broadcast(this))},a.prototype.setValueSmooth=function(a){this.value_=a},a.prototype.incrSequence=function(){this.seq_++},a}(),a("ConcreteVariable",e),a("default",e)}}}),System.register("davinci-newton/checks/isArray.js",[],function(a,b){"use strict";function c(a){return"[object Array]"===Object.prototype.toString.call(a)}b&&b.id;return a("default",c),{setters:[],execute:function(){}}}),System.register("davinci-newton/util/extendArray.js",["../checks/isArray"],function(a,b){"use strict";function c(a,b,c){if(0!==b){if(b<0)throw new Error;var e=a.length;if(a.length=e+b,d["default"](c)){var f=c;if(f.length!==b)throw new Error;for(var g=e,h=a.length;g<h;g++)a[g]=c[g-e]}else for(var g=e,h=a.length;g<h;g++)a[g]=c}}b&&b.id;a("default",c);var d;return{setters:[function(a){d=a}],execute:function(){}}}),System.register("davinci-newton/checks/isNumber.js",[],function(a,b){"use strict";function c(a){return"number"==typeof a}b&&b.id;return a("default",c),{setters:[],execute:function(){}}}),System.register("davinci-newton/checks/isString.js",[],function(a,b){"use strict";function c(a){return"string"==typeof a}b&&b.id;return a("default",c),{setters:[],execute:function(){}}}),System.register("davinci-newton/core/VarsList.js",["../util/AbstractSubject","../util/clone","../model/ConcreteVariable","../util/extendArray","../util/find","../util/findIndex","../util/GenericEvent","../checks/isNumber","../checks/isString","../util/toName","../util/validName"],function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l,m,n,o=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b&&b.id;return{setters:[function(a){c=a},function(a){d=a},function(a){e=a},function(a){f=a},function(a){g=a},function(a){h=a},function(a){i=a},function(a){j=a},function(a){k=a},function(a){l=a},function(a){m=a}],execute:function(){n=function(a){function b(c,d,f){void 0===f&&(f="VARIABLES");var g=a.call(this,f)||this;if(g.timeIdx_=-1,g.varList_=[],g.history_=!0,g.histArray_=[],c.length!==d.length)throw new Error("varNames and localNames are different lengths");for(var h=0,i=c.length;h<i;h++){var j=c[h];if(!k["default"](j))throw new Error("variable name "+j+" is not a string i="+h);j=m["default"](l["default"](j)),c[h]=j,j===b.TIME&&(g.timeIdx_=h)}for(var h=0,i=c.length;h<i;h++)g.varList_.push(new e["default"](g,c[h],d[h]));return g}return o(b,a),b.prototype.findOpenSlot_=function(a){for(var c=0,d=-1,g=0,h=this.varList_.length;g<h;g++)if(this.varList_[g].getName()===b.DELETED){if(d===-1&&(d=g),c++,c>=a)return d}else d=-1,c=0;var i;c>0?i=a-c:(d=this.varList_.length,i=a);var j=[];for(g=0;g<i;g++)j.push(new e["default"](this,b.DELETED,b.DELETED));return f["default"](this.varList_,i,j),d},b.prototype.addVariables=function(a,c){var d=a.length;if(0===d)throw new Error;if(a.length!==c.length)throw new Error("names and localNames are different lengths");for(var f=this.findOpenSlot_(d),g=0;g<d;g++){var h=m["default"](l["default"](a[g]));if(h===b.DELETED)throw new Error("variable cannot be named ''+VarsList.DELETED+''");var j=f+g;this.varList_[j]=new e["default"](this,h,c[g]),h===b.TIME&&(this.timeIdx_=j)}return this.broadcast(new i["default"](this,b.VARS_MODIFIED)),f},b.prototype.deleteVariables=function(a,c){if(0!==c){if(c<0||a<0||a+c>this.varList_.length)throw new Error("deleteVariables");for(var d=a;d<a+c;d++)this.varList_[d]=new e["default"](this,b.DELETED,b.DELETED);this.broadcast(new i["default"](this,b.VARS_MODIFIED))}},b.prototype.incrSequence=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];if(0===arguments.length)for(var c=0,d=this.varList_.length;c<d;c++)this.varList_[c].incrSequence();else for(var c=0,d=arguments.length;c<d;c++){var e=arguments[c];this.checkIndex_(e),this.varList_[e].incrSequence()}},b.prototype.getValue=function(a){return this.checkIndex_(a),this.varList_[a].getValue()},b.prototype.getValues=function(){return this.varList_.map(function(a){return a.getValue()})},b.prototype.setValues=function(a,b){void 0===b&&(b=!1);var c=this.varList_.length,d=a.length;if(d>c)throw new Error("setValues bad length n = "+d+" > N = "+c);for(var e=0;e<c;e++)e<d&&this.setValue(e,a[e],b)},b.prototype.setValue=function(a,b,c){void 0===c&&(c=!1),this.checkIndex_(a);var d=this.varList_[a];if(isNaN(b))throw new Error("cannot set variable "+d.getName()+" to NaN");c?d.setValueSmooth(b):d.setValue(b)},b.prototype.checkIndex_=function(a){if(a<0||a>=this.varList_.length)throw new Error("bad variable index="+a+"; numVars="+this.varList_.length)},b.prototype.addVariable=function(a){var c=a.getName();if(c===b.DELETED)throw new Error('variable cannot be named "'+b.DELETED+'"');var d=this.findOpenSlot_(1);return this.varList_[d]=a,c===b.TIME&&(this.timeIdx_=d),this.broadcast(new i["default"](this,b.VARS_MODIFIED)),d},b.prototype.getHistory=function(){return this.history_},b.prototype.getParameter=function(a){a=l["default"](a);var b=g["default"](this.varList_,function(b){return b.getName()===a});if(null!=b)return b;throw new Error("Parameter not found "+a)},b.prototype.getParameters=function(){return d["default"](this.varList_)},b.prototype.getTime=function(){if(this.timeIdx_<0)throw new Error("no time variable");return this.getValue(this.timeIdx_)},b.prototype.getVariable=function(a){var b;if(j["default"](a))b=a;else{if(!k["default"](a))throw new Error;if(a=l["default"](a),b=h["default"](this.varList_,function(b){return b.getName()===a}),b<0)throw new Error("unknown variable name "+a)}return this.checkIndex_(b),this.varList_[b]},b.prototype.numVariables=function(){return this.varList_.length},b.prototype.saveHistory=function(){if(this.history_){var a=this.getValues();a.push(this.getTime()),this.histArray_.push(a),this.histArray_.length>20&&this.histArray_.shift()}},b.prototype.setComputed=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];for(var c=0,d=arguments.length;c<d;c++){var e=arguments[c];this.checkIndex_(e),this.varList_[e].setComputed(!0)}},b.prototype.setHistory=function(a){this.history_=a},b.prototype.setTime=function(a){this.setValue(this.timeIdx_,a)},b.prototype.timeIndex=function(){return this.timeIdx_},b.prototype.toArray=function(){return d["default"](this.varList_)},b}(c["default"]),n.DELETED="DELETED",n.TIME="TIME",n.VARS_MODIFIED="VARS_MODIFIED",a("VarsList",n),a("default",n)}}}),System.register("davinci-newton/engine/RigidBodySim.js",["../util/AbstractSubject","../util/contains","../model/EnergyInfo","../util/remove","../core/SimList","../core/VarsList"],function(a,b){"use strict";function c(a,b){switch(a){case l.POSITION_X:return"position x";case l.POSITION_Y:return"position y";case l.POSITION_Z:return"position z";case l.ATTITUDE_A:return"attitude a";case l.ATTITUDE_YZ:return"attitude yz";case l.ATTITUDE_ZX:return"attitude zx";case l.ATTITUDE_XY:return"attitude xy";case l.LINEAR_MOMENTUM_X:return"momentum x";case l.LINEAR_MOMENTUM_Y:return"momentum y";case l.LINEAR_MOMENTUM_Z:return"momentum z";case l.ANGULAR_MOMENTUM_YZ:return"angular momentum yz";case l.ANGULAR_MOMENTUM_ZX:return"angular momentum zx";case l.ANGULAR_MOMENTUM_XY:return"angular momentum xy"}throw new Error("getVarName("+a+")")}var d,e,f,g,h,i,j,k,l,m,n,o=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b&&b.id;return{setters:[function(a){d=a},function(a){e=a},function(a){f=a},function(a){g=a},function(a){h=a},function(a){i=a}],execute:function(){j=["time","kinetic enetry","potential energy","total energy"],k=["time","kinetic enetry","potential energy","total energy"],function(a){a[a.POSITION_X=0]="POSITION_X",a[a.POSITION_Y=1]="POSITION_Y",a[a.POSITION_Z=2]="POSITION_Z",a[a.ATTITUDE_A=3]="ATTITUDE_A",a[a.ATTITUDE_YZ=4]="ATTITUDE_YZ",a[a.ATTITUDE_ZX=5]="ATTITUDE_ZX",a[a.ATTITUDE_XY=6]="ATTITUDE_XY",a[a.LINEAR_MOMENTUM_X=7]="LINEAR_MOMENTUM_X",a[a.LINEAR_MOMENTUM_Y=8]="LINEAR_MOMENTUM_Y",a[a.LINEAR_MOMENTUM_Z=9]="LINEAR_MOMENTUM_Z",a[a.ANGULAR_MOMENTUM_YZ=10]="ANGULAR_MOMENTUM_YZ",a[a.ANGULAR_MOMENTUM_ZX=11]="ANGULAR_MOMENTUM_ZX",a[a.ANGULAR_MOMENTUM_XY=12]="ANGULAR_MOMENTUM_XY"}(l||(l={})),m=13,n=function(a){function b(b){void 0===b&&(b="SIM");var c=a.call(this,b)||this;return c.simList_=new h["default"],c.bodies_=[],c.forceLaws_=[],c.showForces_=!1,c.varsList_=new i["default"](j,k,c.getName()+"_VARS"),c}return o(b,a),Object.defineProperty(b.prototype,"showForces",{get:function(){return this.showForces_},set:function(a){this.showForces_=a},enumerable:!0,configurable:!0}),b.prototype.addBody=function(a){if(!e["default"](this.bodies_,a)){for(var b=[],d=0;d<m;d++)b.push(c(d,!1));for(var f=[],d=0;d<m;d++)f.push(c(d,!0));var g=this.varsList_.addVariables(b,f);a.setVarsIndex(g),this.bodies_.push(a),this.getSimList().add(a)}this.initializeFromBody(a),this.bodies_.forEach(function(a){})},b.prototype.removeBody=function(a){e["default"](this.bodies_,a)&&(this.varsList_.deleteVariables(a.getVarsIndex(),m),g["default"](this.bodies_,a),a.setVarsIndex(-1)),this.getSimList().remove(a),this.getVarsList().incrSequence(1,2,3)},b.prototype.addForceLaw=function(a){e["default"](this.forceLaws_,a)||this.forceLaws_.push(a),this.getVarsList().incrSequence(1,2,3)},b.prototype.removeForceLaw=function(a){return a.disconnect(),this.getVarsList().incrSequence(1,2,3),g["default"](this.forceLaws_,a)},b.prototype.moveObjects=function(a){this.bodies_.forEach(function(b){var c=b.getVarsIndex();c<0||(b.X.x=a[c+l.POSITION_X],b.X.y=a[c+l.POSITION_Y],b.X.z=a[c+l.POSITION_Z],b.R.a=a[c+l.ATTITUDE_A],b.R.xy=a[c+l.ATTITUDE_XY],b.R.yz=a[c+l.ATTITUDE_YZ],b.R.zx=a[c+l.ATTITUDE_ZX],b.P.x=a[c+l.LINEAR_MOMENTUM_X],b.P.y=a[c+l.LINEAR_MOMENTUM_Y],b.P.z=a[c+l.LINEAR_MOMENTUM_Z],b.L.xy=a[c+l.ANGULAR_MOMENTUM_XY],b.L.yz=a[c+l.ANGULAR_MOMENTUM_YZ],b.L.zx=a[c+l.ANGULAR_MOMENTUM_ZX],b.V.copy(b.P).divByScalar(b.M),b.ω.dual(b.L).neg().applyMatrix(b.Iinv),b.Ω.dual(b.ω))})},b.prototype.evaluate=function(a,b,c){var d=this;return this.moveObjects(a),this.bodies_.forEach(function(c){var d=c.getVarsIndex();if(!(d<0)){var e=c.M;if(e===Number.POSITIVE_INFINITY)for(var f=0;f<m;f++)b[d+f]=0;else{b[d+l.POSITION_X]=a[d+l.LINEAR_MOMENTUM_X]/e,b[d+l.POSITION_Y]=a[d+l.LINEAR_MOMENTUM_Y]/e,b[d+l.POSITION_Z]=a[d+l.LINEAR_MOMENTUM_Z]/e;var g=c.R,h=c.Ω;b[d+l.ATTITUDE_A]=-.5*(h.xy*g.xy+h.yz*g.yz+h.zx*g.zx),b[d+l.ATTITUDE_XY]=.5*h.xy*g.a,b[d+l.ATTITUDE_YZ]=.5*h.yz*g.a,b[d+l.ATTITUDE_ZX]=.5*h.zx*g.a,b[d+l.LINEAR_MOMENTUM_X]=0,b[d+l.LINEAR_MOMENTUM_Y]=0,b[d+l.LINEAR_MOMENTUM_Z]=0,b[d+l.ANGULAR_MOMENTUM_XY]=0,b[d+l.ANGULAR_MOMENTUM_YZ]=0,b[d+l.ANGULAR_MOMENTUM_ZX]=0}}}),this.forceLaws_.forEach(function(a){var c=a.calculateForces();c.forEach(function(a){d.applyForce(b,a)})}),b[this.varsList_.timeIndex()]=1,null},b.prototype.applyForce=function(a,b){var c=b.getBody();if(e["default"](this.bodies_,c)){var d=c.getVarsIndex();if(!(d<0)){var f=b.F,g=b.Γ;a[d+l.LINEAR_MOMENTUM_X]+=f.x,a[d+l.LINEAR_MOMENTUM_Y]+=f.y,a[d+l.LINEAR_MOMENTUM_Z]+=f.z,a[d+l.ANGULAR_MOMENTUM_YZ]+=g.yz,a[d+l.ANGULAR_MOMENTUM_ZX]+=g.zx,a[d+l.ANGULAR_MOMENTUM_XY]+=g.xy,this.showForces_&&(b.setExpireTime(this.getTime()),this.getSimList().add(b))}}},b.prototype.getTime=function(){return this.varsList_.getTime()},b.prototype.initializeFromBody=function(a){var b=a.getVarsIndex();if(b>-1){var c=this.varsList_;c.setValue(l.POSITION_X+b,a.X.x),c.setValue(l.POSITION_Y+b,a.X.y),c.setValue(l.POSITION_Z+b,a.X.z),c.setValue(l.ATTITUDE_A+b,a.R.a),c.setValue(l.ATTITUDE_XY+b,a.R.xy),c.setValue(l.ATTITUDE_YZ+b,a.R.yz),c.setValue(l.ATTITUDE_ZX+b,a.R.zx),c.setValue(l.LINEAR_MOMENTUM_X+b,a.P.x),c.setValue(l.LINEAR_MOMENTUM_Y+b,a.P.y),c.setValue(l.LINEAR_MOMENTUM_Z+b,a.P.z),c.setValue(l.ANGULAR_MOMENTUM_XY+b,a.L.xy),c.setValue(l.ANGULAR_MOMENTUM_YZ+b,a.L.yz),c.setValue(l.ANGULAR_MOMENTUM_ZX+b,a.L.zx)}this.getVarsList().incrSequence(1,2,3)},b.prototype.modifyObjects=function(){var a=this.varsList_,b=a.getValues();this.moveObjects(b);var c=this.getEnergyInfo_(b);a.setValue(1,c.getTranslational()+c.getRotational(),!0),a.setValue(2,c.getPotential(),!0),a.setValue(3,c.getTotalEnergy(),!0)},b.prototype.getSimList=function(){return this.simList_},b.prototype.getVarsList=function(){return this.varsList_},b.prototype.getEnergyInfo_=function(a){var b=0,c=0,d=0;return this.bodies_.forEach(function(a){isFinite(a.M)&&(c+=a.rotationalEnergy(),d+=a.translationalEnergy())}),this.forceLaws_.forEach(function(a){b+=a.getPotentialEnergy()}),new f["default"](b+this.potentialOffset_,d,c)},b.prototype.saveState=function(){this.recentState_=this.varsList_.getValues(),this.bodies_.forEach(function(a){})},b.prototype.restoreState=function(){null!=this.recentState_&&this.varsList_.setValues(this.recentState_,!0),this.bodies_.forEach(function(a){})},b.prototype.findCollisions=function(a,b,c){throw new Error("TODO: findCollisions")},b}(d["default"]),a("default",n)}}}),System.register("davinci-newton/util/zeroArray.js",[],function(a,b){"use strict";function c(a){for(var b=a.length,c=0;c<b;c++)a[c]=0}b&&b.id;return a("default",c),{setters:[],execute:function(){}}}),System.register("davinci-newton/model/RungeKutta.js",["../util/zeroArray"],function(a,b){"use strict";var c,d;b&&b.id;return{setters:[function(a){c=a}],execute:function(){d=function(){function a(a){this.ode_=a,this.inp_=[],this.k1_=[],this.k2_=[],this.k3_=[],this.k4_=[]}return a.prototype.step=function(a){var b,d,e=this.ode_.getVarsList(),f=e.getValues(),g=f.length;this.inp_.length<g&&(this.inp_=new Array(g),this.k1_=new Array(g),this.k2_=new Array(g),this.k3_=new Array(g),this.k4_=new Array(g));var h=this.inp_,i=this.k1_,j=this.k2_,k=this.k3_,l=this.k4_;for(d=0;d<g;d++)h[d]=f[d];if(c["default"](i),b=this.ode_.evaluate(h,i,0),null!==b)return b;for(d=0;d<g;d++)h[d]=f[d]+i[d]*a/2;if(c["default"](j),b=this.ode_.evaluate(h,j,a/2),null!==b)return b;for(d=0;d<g;d++)h[d]=f[d]+j[d]*a/2;if(c["default"](k),b=this.ode_.evaluate(h,k,a/2),null!==b)return b;for(d=0;d<g;d++)h[d]=f[d]+k[d]*a;if(c["default"](l),b=this.ode_.evaluate(h,l,a),null!==b)return b;for(d=0;d<g;d++)f[d]+=(i[d]+2*j[d]+2*k[d]+l[d])*a/6;return e.setValues(f,!0),null},a}(),a("RungeKutta",d),a("default",d)}}}),System.register("davinci-newton/strategy/SimpleAdvance.js",[],function(a,b){"use strict";var c;b&&b.id;return{setters:[],execute:function(){c=function(){function a(a,b){this.sim_=a,this.odeSolver_=b,this.timeStep_=.025}return a.prototype.advance=function(a,b){this.sim_.getSimList().removeTemporary(this.sim_.getTime());var c=this.odeSolver_.step(a);if(null!=c)throw new Error("error during advance "+c);this.sim_.modifyObjects(),void 0!==b&&b.memorize()},a.prototype.getTime=function(){return this.sim_.getTime()},a.prototype.getTimeStep=function(){return this.timeStep_},a}(),a("SimpleAdvance",c),a("default",c)}}}),System.register("davinci-newton/util/getSystemTime.js",[],function(a,b){"use strict";function c(){return.001*Date.now()}b&&b.id;return a("default",c),{setters:[],execute:function(){}}}),System.register("davinci-newton/runner/Clock.js",["../util/AbstractSubject","../util/GenericEvent","../util/getSystemTime"],function(a,b){"use strict";var c,d,e,f,g=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b&&b.id;return{setters:[function(a){c=a},function(a){d=a},function(a){e=a}],execute:function(){f=function(a){function b(b){void 0===b&&(b="CLOCK");var c=a.call(this,b)||this;return c.clockStart_sys_secs_=e["default"](),c.isRunning_=!1,c.saveTime_secs_=0,c.saveRealTime_secs_=0,c.stepMode_=!1,c.tasks_=[],c.timeRate_=1,c.realStart_sys_secs_=c.clockStart_sys_secs_,c}return g(b,a),b.prototype.clearStepMode=function(){this.stepMode_=!1},b.prototype.getTime=function(){return this.isRunning_?(e["default"]()-this.clockStart_sys_secs_)*this.timeRate_:this.saveTime_secs_},b.prototype.resume=function(){this.clearStepMode(),this.isRunning_||(this.isRunning_=!0,this.setTimePrivate(this.saveTime_secs_),this.setRealTime(this.saveRealTime_secs_),this.broadcast(new d["default"](this,b.CLOCK_RESUME)))},b.prototype.setTime=function(a){this.setTimePrivate(a),this.broadcast(new d["default"](this,b.CLOCK_SET_TIME))},b.prototype.setTimePrivate=function(a){this.isRunning_?(this.clockStart_sys_secs_=e["default"]()-a/this.timeRate_,this.scheduleAllClockTasks()):this.saveTime_secs_=a},b.prototype.scheduleAllClockTasks=function(){var a=this;this.tasks_.forEach(function(b){a.scheduleTask(b)})},b.prototype.scheduleTask=function(a){if(a.cancel(),this.isRunning_){var b=this.clockToSystem(this.getTime()),c=this.clockToSystem(a.getTime());c>=b&&a.schedule(c-b)}},b.prototype.setRealTime=function(a){this.isRunning_?this.realStart_sys_secs_=e["default"]()-a/this.timeRate_:this.saveRealTime_secs_=a},b.prototype.clockToSystem=function(a){return a/this.timeRate_+this.clockStart_sys_secs_},b}(c["default"]),f.CLOCK_RESUME="CLOCK_RESUME",f.CLOCK_SET_TIME="CLOCK_SET_TIME",a("Clock",f),a("default",f)}}}),System.register("davinci-newton/runner/SimRunner.js",["./Clock"],function(a,b){"use strict";var c,d;b&&b.id;return{setters:[function(a){c=a}],execute:function(){d=function(){function a(a,b){this.advanceStrategy_=a,this.clock_=new c["default"],this.timeStep_=a.getTimeStep()}return a.prototype.getClock=function(){return this.clock_},a.prototype.advanceToTargetTime=function(a,b){for(var c=a.getTime();c<b;){a.advance(this.timeStep_,this);var d=c;if(c=a.getTime(),c-d<=1e-15)throw new Error("SimRunner time did not advance")}},a.prototype.update=function(){var a=this.clock_.getTime(),b=this.advanceStrategy_.getTime();if(a>b+1||a<b-1){var c=b+this.timeStep_;this.clock_.setTime(c),this.clock_.setRealTime(c),a=c}var d=a,e=d-this.timeStep_/10;this.advanceToTargetTime(this.advanceStrategy_,e)},a.prototype.memorize=function(){},a}(),a("SimRunner",d),a("default",d)}}}),System.register("davinci-newton/view/AffineTransform.js",["./Point"],function(a,b){"use strict";var c,d;b&&b.id;return{setters:[function(a){c=a}],execute:function(){d=function(){function a(a,b,c,d,e,f){this.m11_=a,this.m12_=b,this.m21_=c,this.m22_=d,this.dx_=e,this.dy_=f}return a.prototype.applyTransform=function(a){return a.transform(this.m11_,this.m12_,this.m21_,this.m22_,this.dx_,this.dy_),this},a.prototype.concatenate=function(b){var c=this.m11_*b.m11_+this.m21_*b.m12_,d=this.m12_*b.m11_+this.m22_*b.m12_,e=this.m11_*b.m21_+this.m21_*b.m22_,f=this.m12_*b.m21_+this.m22_*b.m22_,g=this.m11_*b.dx_+this.m21_*b.dy_+this.dx_,h=this.m12_*b.dx_+this.m22_*b.dy_+this.dy_;return new a(c,d,e,f,g,h)},a.prototype.lineTo=function(a,b,c){var d=this.transform(a,b);return c.lineTo(d.x,d.y),this},a.prototype.moveTo=function(a,b,c){var d=this.transform(a,b);return c.moveTo(d.x,d.y),this},a.prototype.rotate=function(b){var c=Math.cos(b),d=Math.sin(b),e=c*this.m11_+d*this.m21_,f=c*this.m12_+d*this.m22_,g=-d*this.m11_+c*this.m21_,h=-d*this.m12_+c*this.m22_;return new a(e,f,g,h,this.dx_,this.dy_)},a.prototype.scale=function(b,c){var d=this.m11_*b,e=this.m12_*b,f=this.m21_*c,g=this.m22_*c;return new a(d,e,f,g,this.dx_,this.dy_)},a.prototype.setTransform=function(a){return a.setTransform(this.m11_,this.m12_,this.m21_,this.m22_,this.dx_,this.dy_),this},a.prototype.transform=function(a,b){var d=this.m11_*a+this.m21_*b+this.dx_,e=this.m12_*a+this.m22_*b+this.dy_;return new c["default"](d,e)},a.prototype.translate=function(b,c){var d=this.dx_+this.m11_*b+this.m21_*c,e=this.dy_+this.m12_*b+this.m22_*c;return new a(this.m11_,this.m12_,this.m21_,this.m22_,d,e)},a}(),d.IDENTITY=new d(1,0,0,1,0,0),a("default",d)}}}),System.register("davinci-newton/checks/mustBeFinite.js",[],function(a,b){"use strict";function c(a){if("number"!=typeof a||!isFinite(a))throw new Error("not a finite number "+a);return a}b&&b.id;return a("default",c),{setters:[],execute:function(){}}}),System.register("davinci-newton/view/CoordMap.js",["./AffineTransform","./DoubleRect","./HorizAlign","../checks/mustBeFinite","./Point","./ScreenRect","./VerticalAlign"],function(a,b){"use strict";var c,d,e,f,g,h,i,j,k;b&&b.id;return{setters:[function(a){c=a},function(a){d=a},function(a){e=a},function(a){f=a},function(a){g=a},function(a){h=a},function(a){i=a}],execute:function(){j=1e-15,k=function(){function a(a,b,d,e,g,h){this.screen_left_=f["default"](a),this.screen_bottom_=f["default"](b),this.sim_left_=f["default"](d),this.sim_bottom_=f["default"](e),this.pixel_per_unit_x_=f["default"](g),this.pixel_per_unit_y_=f["default"](h);var i=c["default"].IDENTITY;i=i.translate(this.screen_left_,this.screen_bottom_),i=i.scale(this.pixel_per_unit_x_,-this.pixel_per_unit_y_),i=i.translate(-this.sim_left_,-this.sim_bottom_),this.transform_=i}return a.make=function(b,c,d,f,g){if(void 0===d&&(d=e["default"].MIDDLE),void 0===f&&(f=i["default"].MIDDLE),void 0===g&&(g=1),g<j||!isFinite(g))throw new Error("bad aspectRatio "+g);var h=c.getLeft(),k=c.getBottom(),l=c.getRight()-h,m=c.getTop()-k;if(l<j||m<j)throw new Error("simRect cannot be empty "+c);var n=b.getTop(),o=b.getLeft(),p=b.getWidth(),q=b.getHeight(),r=0,s=0,t=0,u=0;if(d===e["default"].FULL&&(t=p/l,r=0),f===i["default"].FULL&&(u=q/m,s=0),d!==e["default"].FULL||f!==i["default"].FULL){var v;if(d===e["default"].FULL)u=t*g,v=!0;else if(f===i["default"].FULL)t=u/g,v=!1;else{t=p/l,u=t*g,v=!0;var w=Math.floor(.5+u*m);q<w&&(u=q/m,t=u/g,v=!1)}if(v){r=0;var w=Math.floor(.5+m*u);switch(f){case i["default"].BOTTOM:s=0;break;case i["default"].MIDDLE:s=(q-w)/2;break;case i["default"].TOP:s=q-w;break;default:throw new Error}}else{s=0;var x=Math.floor(.5+l*t);switch(d){case e["default"].LEFT:r=0;break;case e["default"].MIDDLE:r=(p-x)/2;break;case e["default"].RIGHT:r=p-x;break;default:throw new Error}}}var y=new a(o,n+q,h-r/t,k-s/u,t,u);
return y},a.isDuckType=function(b){return b instanceof a||void 0!==b.getAffineTransform&&void 0!==b.simToScreenX&&void 0!==b.simToScreenY&&void 0!==b.screenToSimX&&void 0!==b.screenToSimY&&void 0!==b.getScaleX&&void 0!==b.getScaleY},a.prototype.getAffineTransform=function(){return this.transform_},a.prototype.getScaleX=function(){return this.pixel_per_unit_x_},a.prototype.getScaleY=function(){return this.pixel_per_unit_y_},a.prototype.screenToSim=function(a,b){return new g["default"](this.screenToSimX(a),this.screenToSimY(b))},a.prototype.screenToSimRect=function(a){return new d["default"](this.screenToSimX(a.getLeft()),this.screenToSimY(a.getTop()+a.getHeight()),this.screenToSimX(a.getLeft()+a.getWidth()),this.screenToSimY(a.getTop()))},a.prototype.screenToSimScaleX=function(a){return a/this.pixel_per_unit_x_},a.prototype.screenToSimScaleY=function(a){return a/this.pixel_per_unit_y_},a.prototype.screenToSimX=function(a){return this.sim_left_+(a-this.screen_left_)/this.pixel_per_unit_x_},a.prototype.screenToSimY=function(a){return this.sim_bottom_+(this.screen_bottom_-a)/this.pixel_per_unit_y_},a.prototype.simToScreen=function(a){return new g["default"](this.simToScreenX(a.x),this.simToScreenY(a.y))},a.prototype.simToScreenRect=function(a){return new h["default"](this.simToScreenX(a.getLeft()),this.simToScreenY(a.getTop()),this.simToScreenScaleX(a.getWidth()),this.simToScreenScaleY(a.getHeight()))},a.prototype.simToScreenScaleX=function(a){return a*this.pixel_per_unit_x_},a.prototype.simToScreenScaleY=function(a){return a*this.pixel_per_unit_y_},a.prototype.simToScreenX=function(a){return this.screen_left_+(a-this.sim_left_)*this.pixel_per_unit_x_},a.prototype.simToScreenY=function(a){return this.screen_bottom_-(a-this.sim_bottom_)*this.pixel_per_unit_y_},a}(),a("default",k)}}}),System.register("davinci-newton/util/clone.js",[],function(a,b){"use strict";function c(a){throw new Error("TODO: clone")}b&&b.id;return a("default",c),{setters:[],execute:function(){}}}),System.register("davinci-newton/util/contains.js",[],function(a,b){"use strict";function c(a,b){for(var c=a.length,d=0;d<c;d++)if(a[d]===b)return!0;return!1}b&&b.id;return a("default",c),{setters:[],execute:function(){}}}),System.register("davinci-newton/util/findIndex.js",[],function(a,b){"use strict";function c(a,b){for(var c=a.length,d=0;d<c;d++){var e=a[d];if(b(e,d))return d}return-1}b&&b.id;return a("default",c),{setters:[],execute:function(){}}}),System.register("davinci-newton/util/find.js",["./findIndex"],function(a,b){"use strict";function c(a,b){var c=d["default"](a,b);return c<0?null:a[c]}b&&b.id;a("default",c);var d;return{setters:[function(a){d=a}],execute:function(){}}}),System.register("davinci-newton/util/AbstractSubject.js",["./clone","./contains","./find","./remove","../util/toName","../util/validName"],function(a,b){"use strict";var c,d,e,f,g,h,i;b&&b.id;return{setters:[function(a){c=a},function(a){d=a},function(a){e=a},function(a){f=a},function(a){g=a},function(a){h=a}],execute:function(){i=function(){function a(a){if(this.doBroadcast_=!0,this.observers_=[],this.paramList_=[],!a)throw new Error("no name");this.name_=h["default"](g["default"](a))}return a.prototype.getName=function(){return this.name_},a.prototype.addObserver=function(a){d["default"](this.observers_,a)||this.observers_.push(a)},a.prototype.removeObserver=function(a){f["default"](this.observers_,a)},a.prototype.addParameter=function(a){var b=a.getName(),c=this.getParam(b);if(null!=c)throw new Error("parameter "+b+" already exists: "+c);this.paramList_.push(a)},a.prototype.getParam=function(a){return a=g["default"](a),e["default"](this.paramList_,function(b){return b.getName()===a})},a.prototype.getParameter=function(a){var b=this.getParam(a);if(null!=b)return b;throw new Error("Parameter not found "+a)},a.prototype.broadcast=function(a){if(this.doBroadcast_)for(var b=this.observers_.length,c=0;c<b;c++)this.observers_[c].observe(a)},a.prototype.broadcastParameter=function(a){var b=this.getParam(a);if(null===b)throw new Error("unknown Parameter "+a);this.broadcast(b)},a.prototype.getBroadcast=function(){return this.doBroadcast_},a.prototype.getObservers=function(){return c["default"](this.observers_)},a}(),a("AbstractSubject",i),a("default",i)}}}),System.register("davinci-newton/util/insertAt.js",[],function(a,b){"use strict";function c(a,b,c){return arguments.length<=2?Array.prototype.slice.call(a,b):Array.prototype.slice.call(a,b,c)}function d(a,b,d,e){return Array.prototype.splice.apply(a,c(arguments,1))}function e(a,b,c){void 0===c&&(c=0),d(a,c,0,b)}b&&b.id;return a("default",e),{setters:[],execute:function(){}}}),System.register("davinci-newton/checks/isObject.js",[],function(a,b){"use strict";function c(a){return"object"==typeof a}b&&b.id;return a("default",c),{setters:[],execute:function(){}}}),System.register("davinci-newton/view/DisplayList.js",["../util/AbstractSubject","../util/GenericEvent","../util/insertAt","../checks/isObject"],function(a,b){"use strict";var c,d,e,f,g,h=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b&&b.id;return{setters:[function(a){c=a},function(a){d=a},function(a){e=a},function(a){f=a}],execute:function(){g=function(a){function b(c){var d=a.call(this,c||"DISPLAY_LIST_"+b.NAME_ID++)||this;return d.drawables_=[],d}return h(b,a),b.prototype.add=function(a){if(!f["default"](a))throw new Error("non-object passed to DisplayList.add");var c=a.getZIndex();this.sort();for(var g=0,h=this.drawables_.length;g<h;g++){var i=this.drawables_[g].getZIndex();if(c<i)break}e["default"](this.drawables_,a,g),this.broadcast(new d["default"](this,b.OBJECT_ADDED,a))},b.prototype.draw=function(a,b){this.sort();for(var c=this.drawables_,d=c.length,e=0;e<d;e++)c[e].draw(a,b)},b.prototype.prepend=function(a){if(!f["default"](a))throw new Error("non-object passed to DisplayList.add");var c=a.getZIndex();this.sort();for(var g=this.drawables_.length,h=g;h>0;h--){var i=this.drawables_[h-1].getZIndex();if(c>i)break}e["default"](this.drawables_,a,h),this.broadcast(new d["default"](this,b.OBJECT_ADDED,a))},b.prototype.sort=function(){},b}(c["default"]),g.NAME_ID=1,g.OBJECT_ADDED="OBJECT_ADDED",g.OBJECT_REMOVED="OBJECT_REMOVED",a("DisplayList",g),a("default",g)}}}),System.register("davinci-newton/view/Point.js",[],function(a,b){"use strict";var c;b&&b.id;return{setters:[],execute:function(){c=function(){function a(a,b){this.x_=a,this.y_=b}return Object.defineProperty(a.prototype,"x",{get:function(){return this.x_},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"y",{get:function(){return this.y_},enumerable:!0,configurable:!0}),a}(),a("default",c)}}}),System.register("davinci-newton/view/DoubleRect.js",["./Point","../util/veryDifferent"],function(a,b){"use strict";var c,d,e;b&&b.id;return{setters:[function(a){c=a},function(a){d=a}],execute:function(){e=function(){function a(a,b,c,d){if(this.left_=a,this.right_=c,this.bottom_=b,this.top_=d,a>c)throw new Error("DoubleRect: left > right "+a+" > "+c);if(b>d)throw new Error("DoubleRect: bottom > top "+b+" > "+d)}return a.clone=function(b){return new a(b.getLeft(),b.getBottom(),b.getRight(),b.getTop())},a.isDuckType=function(b){return b instanceof a||void 0!==b.getLeft&&void 0!==b.getRight&&void 0!==b.getTop&&void 0!==b.getBottom&&void 0!==b.translate&&void 0!==b.scale},a.make=function(b,c){var d=Math.min(b.x,c.x),e=Math.max(b.x,c.x),f=Math.min(b.y,c.y),g=Math.max(b.y,c.y);return new a(d,f,e,g)},a.makeCentered=function(b,c,d){var e=b.x,f=b.y;return new a(e-c/2,f-d/2,e+c/2,f+d/2)},a.makeCentered2=function(b,c){var d=b.x,e=b.y,f=c.x,g=c.y;return new a(d-f/2,e-g/2,d+f/2,e+g/2)},a.prototype.contains=function(a){return a.x>=this.left_&&a.x<=this.right_&&a.y>=this.bottom_&&a.y<=this.top_},a.prototype.equals=function(b){return b===this||b instanceof a&&(b.getLeft()===this.left_&&b.getRight()===this.right_&&b.getBottom()===this.bottom_&&b.getTop()===this.top_)},a.prototype.expand=function(b,c){return c=void 0===c?b:c,new a(this.getLeft()-b,this.getBottom()-c,this.getRight()+b,this.getTop()+b)},a.prototype.getBottom=function(){return this.bottom_},a.prototype.getCenter=function(){return new c["default"](this.getCenterX(),this.getCenterY())},a.prototype.getCenterX=function(){return(this.left_+this.right_)/2},a.prototype.getCenterY=function(){return(this.bottom_+this.top_)/2},a.prototype.getHeight=function(){return this.top_-this.bottom_},a.prototype.getLeft=function(){return this.left_},a.prototype.getRight=function(){return this.right_},a.prototype.getTop=function(){return this.top_},a.prototype.getWidth=function(){return this.right_-this.left_},a.prototype.isEmpty=function(a){return void 0===a&&(a=1e-16),this.getWidth()<a||this.getHeight()<a},a.prototype.maybeVisible=function(a,b){if(this.contains(a)||this.contains(b))return!0;var c=a.x,d=a.y,e=b.x,f=b.y,g=this.left_;return!(c<g&&e<g)&&(g=this.right_,!(c>g&&e>g)&&(g=this.bottom_,!(d<g&&f<g)&&(g=this.top_,!(d>g&&f>g))))},a.prototype.nearEqual=function(a,b){return!d["default"](this.left_,a.getLeft(),b)&&(!d["default"](this.bottom_,a.getBottom(),b)&&(!d["default"](this.right_,a.getRight(),b)&&!d["default"](this.top_,a.getTop(),b)))},a.prototype.scale=function(b,c){c=void 0===c?b:c;var d=this.getCenterX(),e=this.getCenterY(),f=this.getWidth(),g=this.getHeight();return new a(d-b*f/2,e-c*g/2,d+b*f/2,e+c*g/2)},a.prototype.translate=function(b,c){return new a(this.left_+b,this.bottom_+c,this.right_+b,this.top_+c)},a.prototype.union=function(b){return new a(Math.min(this.left_,b.getLeft()),Math.min(this.bottom_,b.getBottom()),Math.max(this.right_,b.getRight()),Math.max(this.top_,b.getTop()))},a.prototype.unionPoint=function(b){return new a(Math.min(this.left_,b.x),Math.min(this.bottom_,b.y),Math.max(this.right_,b.x),Math.max(this.top_,b.y))},a}(),e.EMPTY_RECT=new e(0,0,0,0),a("default",e)}}}),System.register("davinci-newton/util/GenericEvent.js",["./toName","./validName"],function(a,b){"use strict";var c,d,e;b&&b.id;return{setters:[function(a){c=a},function(a){d=a}],execute:function(){e=function(){function a(a,b,e){this.subject_=a,this.value_=e,this.name_=d["default"](c["default"](b))}return a.prototype.getName=function(a){return this.name_},a.prototype.getSubject=function(){return this.subject_},a.prototype.nameEquals=function(a){return this.name_===c["default"](a)},a}(),a("GenericEvent",e),a("default",e)}}}),System.register("davinci-newton/view/HorizAlign.js",[],function(a,b){"use strict";var c;b&&b.id;return{setters:[],execute:function(){!function(a){a[a.LEFT=0]="LEFT",a[a.MIDDLE=1]="MIDDLE",a[a.RIGHT=2]="RIGHT",a[a.FULL=3]="FULL"}(c||(c={})),a("HorizAlign",c),a("default",c)}}}),System.register("davinci-newton/util/ParameterBoolean.js",["./toName","./validName"],function(a,b){"use strict";var c,d,e;b&&b.id;return{setters:[function(a){c=a},function(a){d=a}],execute:function(){e=function(){function a(a,b,e,f,g,h){this.subject_=a,this.name_=d["default"](c["default"](b)),this.getter_=e,this.setter_=f,this.isComputed_=!1,this.choices_=[],this.values_=[]}return a.prototype.getName=function(){return this.name_},a.prototype.getSubject=function(){return this.subject_},a.prototype.nameEquals=function(a){return this.name_===c["default"](a)},a.prototype.setComputed=function(a){this.isComputed_=a},a}(),a("ParameterBoolean",e),a("default",e)}}}),System.register("davinci-newton/util/ParameterNumber.js",["./toName","./validName"],function(a,b){"use strict";var c,d,e;b&&b.id;return{setters:[function(a){c=a},function(a){d=a}],execute:function(){e=function(){function a(a,b,e,f,g,h){this.subject_=a,this.name_=d["default"](c["default"](b)),this.getter_=e,this.setter_=f,this.isComputed_=!1,this.signifDigits_=3,this.decimalPlaces_=-1,this.lowerLimit_=0,this.upperLimit_=Number.POSITIVE_INFINITY,this.choices_=[],this.values_=[]}return a.prototype.getName=function(){return this.name_},a.prototype.getSubject=function(){return this.subject_},a.prototype.getValue=function(){return this.getter_()},a.prototype.nameEquals=function(a){return this.name_===c["default"](a)},a.prototype.setComputed=function(a){this.isComputed_=a},a.prototype.setLowerLimit=function(a){if(a>this.getValue()||a>this.upperLimit_)throw new Error("out of range");return this.lowerLimit_=a,this},a}(),a("ParameterNumber",e),a("default",e)}}}),System.register("davinci-newton/util/removeAt.js",[],function(a,b){"use strict";function c(a,b){return 1===Array.prototype.splice.call(a,b,1).length}b&&b.id;return a("default",c),{setters:[],execute:function(){}}}),System.register("davinci-newton/util/remove.js",["./removeAt"],function(a,b){"use strict";function c(a,b){var c,e=a.indexOf(b);return(c=e>=0)&&d["default"](a,e),c}b&&b.id;a("default",c);var d;return{setters:[function(a){d=a}],execute:function(){}}}),System.register("davinci-newton/checks/isFunction.js",[],function(a,b){"use strict";function c(a){return"function"==typeof a}b&&b.id;return a("default",c),{setters:[],execute:function(){}}}),System.register("davinci-newton/view/ScreenRect.js",["../checks/isFunction","../util/veryDifferent"],function(a,b){"use strict";var c,d,e;b&&b.id;return{setters:[function(a){c=a},function(a){d=a}],execute:function(){e=function(){function a(a,b,c,d){if(c<0||d<0)throw new Error;this.left_=a,this.top_=b,this.width_=c,this.height_=d}return a.clone=function(b){return new a(b.left_,b.top_,b.width_,b.height_)},a.prototype.equals=function(a){return this.left_===a.left_&&this.top_===a.top_&&this.width_===a.width_&&this.height_===a.height_},a.isDuckType=function(b){return b instanceof a||void 0!==b.getLeft&&void 0!==b.getTop&&void 0!==b.getWidth&&void 0!==b.getHeight&&void 0!==b.isEmpty&&void 0!==b.equals&&void 0!==b.nearEqual},a.prototype.getCenterX=function(){return this.left_+this.width_/2},a.prototype.getCenterY=function(){return this.top_+this.height_/2},a.prototype.getHeight=function(){return this.height_},a.prototype.getLeft=function(){return this.left_},a.prototype.getTop=function(){return this.top_},a.prototype.getWidth=function(){return this.width_},a.prototype.isEmpty=function(a){return void 0===a&&(a=1e-14),this.width_<a||this.height_<a},a.prototype.makeOval=function(a){var b=this.width_/2,d=this.height_/2;if(c["default"](a.ellipse))a.beginPath(),a.moveTo(this.left_+this.width_,this.top_+d),a.ellipse(this.left_+b,this.top_+d,b,d,0,0,2*Math.PI,!1);else{var e=Math.min(b,d);a.beginPath(),a.moveTo(this.left_+this.width_,this.top_),a.arc(this.left_+b,this.top_+d,e,0,2*Math.PI,!1),a.closePath()}},a.prototype.makeRect=function(a){a.rect(this.left_,this.top_,this.width_,this.height_)},a.prototype.nearEqual=function(a,b){return!d["default"](this.left_,a.left_,b)&&(!d["default"](this.top_,a.top_,b)&&(!d["default"](this.width_,a.width_,b)&&!d["default"](this.height_,a.height_,b)))},a}(),e.EMPTY_RECT=new e(0,0,0,0),a("default",e)}}}),System.register("davinci-newton/view/VerticalAlign.js",[],function(a,b){"use strict";var c;b&&b.id;return{setters:[],execute:function(){!function(a){a[a.TOP=0]="TOP",a[a.MIDDLE=1]="MIDDLE",a[a.BOTTOM=2]="BOTTOM",a[a.FULL=3]="FULL"}(c||(c={})),a("VerticalAlign",c),a("default",c)}}}),System.register("davinci-newton/view/SimView.js",["../util/AbstractSubject","../util/clone","../util/contains","./CoordMap","./DisplayList","./DoubleRect","../util/GenericEvent","./HorizAlign","../util/ParameterBoolean","../util/ParameterNumber","../util/remove","./ScreenRect","./VerticalAlign","../util/veryDifferent"],function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b&&b.id;return{setters:[function(a){c=a},function(a){d=a},function(a){e=a},function(a){f=a},function(a){g=a},function(a){h=a},function(a){i=a},function(a){j=a},function(a){k=a},function(a){l=a},function(a){m=a},function(a){n=a},function(a){o=a},function(a){p=a}],execute:function(){q="COORD_MAP_CHANGED",r="SCREEN_RECT_CHANGED",s=function(a){function b(c,d){var e=a.call(this,c)||this;if(e.panX=.05,e.panY=.05,e.zoom=1.1,e.screenRect_=new n["default"](0,0,800,600),e.horizAlign_=j["default"].MIDDLE,e.verticalAlign_=o["default"].MIDDLE,e.aspectRatio_=1,e.displayList_=new g["default"],e.scaleTogether_=!0,e.opaqueness=1,e.memorizables_=[],!(d instanceof h["default"])||d.isEmpty())throw new Error("bad simRect: "+d);return e.simRect_=d,e.coordMap_=f["default"].make(e.screenRect_,e.simRect_,e.horizAlign_,e.verticalAlign_,e.aspectRatio_),e.width_=d.getWidth(),e.height_=d.getHeight(),e.centerX_=d.getCenterX(),e.centerY_=d.getCenterY(),e.ratio_=e.height_/e.width_,e.addParameter(new l["default"](e,b.PARAM_NAME_WIDTH,function(){return e.getWidth()},function(a){return e.setWidth(a)})),e.addParameter(new l["default"](e,b.PARAM_NAME_HEIGHT,function(){return e.getHeight()},function(a){return e.setHeight(a)})),e.addParameter(new l["default"](e,b.PARAM_NAME_CENTER_X,function(){return e.getCenterX()},function(a){return e.setCenterX(a)}).setLowerLimit(Number.NEGATIVE_INFINITY)),e.addParameter(new l["default"](e,b.PARAM_NAME_CENTER_Y,function(){return e.getCenterY()},function(a){return e.setCenterY(a)}).setLowerLimit(Number.NEGATIVE_INFINITY)),e.addParameter(new k["default"](e,b.PARAM_NAME_SCALE_TOGETHER,function(){return e.getScaleTogether()},function(a){return e.setScaleTogether(a)})),e.addParameter(new l["default"](e,b.PARAM_NAME_VERTICAL_ALIGN,function(){return e.getVerticalAlign()},function(a){return e.setVerticalAlign(a)})),e.addParameter(new l["default"](e,b.PARAM_NAME_HORIZONTAL_ALIGN,function(){return e.getHorizAlign()},function(a){return e.setHorizAlign(a)})),e.addParameter(new l["default"](e,b.PARAM_NAME_ASPECT_RATIO,function(){return e.getAspectRatio()},function(a){return e.setAspectRatio(a)})),e}return t(b,a),b.prototype.addMemo=function(a){e["default"](this.memorizables_,a)||this.memorizables_.push(a)},b.prototype.gainFocus=function(){},b.prototype.getAspectRatio=function(){return this.aspectRatio_},b.prototype.getCenterX=function(){return this.centerX_},b.prototype.getCenterY=function(){return this.centerY_},b.prototype.getCoordMap=function(){return this.coordMap_},b.prototype.getDisplayList=function(){return this.displayList_},b.prototype.getHeight=function(){return this.height_},b.prototype.getHorizAlign=function(){return this.horizAlign_},b.prototype.getMemos=function(){return d["default"](this.memorizables_)},b.prototype.getScaleTogether=function(){return this.scaleTogether_},b.prototype.getScreenRect=function(){return this.screenRect_},b.prototype.getSimRect=function(){return this.simRect_},b.prototype.getVerticalAlign=function(){return this.verticalAlign_},b.prototype.getWidth=function(){return this.width_},b.prototype.loseFocus=function(){},b.prototype.paint=function(a){a.save(),a.globalAlpha=this.opaqueness,this.displayList_.draw(a,this.coordMap_),a.restore()},b.prototype.setCoordMap=function(a){if(!f["default"].isDuckType(a))throw new Error("not a CoordMap: "+a);this.coordMap_=a,this.broadcast(new i["default"](this,q))},b.prototype.setScreenRect=function(a){if(!n["default"].isDuckType(a))throw new Error("not a ScreenRect: "+a);if(a.isEmpty())throw new Error("empty screenrect");this.screenRect_.equals(a)||(this.screenRect_=a,this.realign(),this.broadcast(new i["default"](this,r)))},b.prototype.setSimRect=function(a){if(!h["default"].isDuckType(a))throw new Error("not a DoubleRect: "+a);a.equals(this.simRect_)||(this.simRect_=a,this.realign(),this.broadcastParameter(b.PARAM_NAME_WIDTH),this.broadcastParameter(b.PARAM_NAME_HEIGHT),this.broadcastParameter(b.PARAM_NAME_CENTER_X),this.broadcastParameter(b.PARAM_NAME_CENTER_Y),this.broadcast(new i["default"](this,b.SIM_RECT_CHANGED)))},b.prototype.memorize=function(){for(var a=0,b=this.memorizables_.length;a<b;a++)this.memorizables_[a].memorize()},b.prototype.realign=function(){this.setCoordMap(f["default"].make(this.screenRect_,this.simRect_,this.horizAlign_,this.verticalAlign_,this.aspectRatio_)),this.width_=this.simRect_.getWidth(),this.height_=this.simRect_.getHeight(),this.centerX_=this.simRect_.getCenterX(),this.centerY_=this.simRect_.getCenterY(),this.ratio_=this.height_/this.width_},b.prototype.modifySimRect=function(){var a=this.centerX_-this.width_/2,b=this.centerY_-this.height_/2,c=new h["default"](a,b,a+this.width_,b+this.height_);this.setSimRect(c)},b.prototype.panDown=function(){this.setCenterY(this.centerY_-this.panY*this.height_)},b.prototype.panLeft=function(){this.setCenterX(this.centerX_-this.panX*this.width_)},b.prototype.panRight=function(){this.setCenterX(this.centerX_+this.panX*this.width_)},b.prototype.panUp=function(){this.setCenterY(this.centerY_+this.panY*this.height_)},b.prototype.removeMemo=function(a){m["default"](this.memorizables_,a)},b.prototype.setAspectRatio=function(a){p["default"](this.aspectRatio_,a)&&(this.aspectRatio_=a,this.realign(),this.broadcastParameter(b.PARAM_NAME_ASPECT_RATIO))},b.prototype.setCenterX=function(a){p["default"](this.centerX_,a)&&(this.centerX_=a,this.modifySimRect())},b.prototype.setCenterY=function(a){p["default"](this.centerY_,a)&&(this.centerY_=a,this.modifySimRect())},b.prototype.setHeight=function(a){p["default"](this.height_,a)&&(this.height_=a,this.scaleTogether_&&(this.width_=this.height_/this.ratio_),this.modifySimRect())},b.prototype.setHorizAlign=function(a){this.horizAlign_=a,this.realign(),this.broadcastParameter(b.PARAM_NAME_HORIZONTAL_ALIGN)},b.prototype.setScaleTogether=function(a){this.scaleTogether_!==a&&(this.scaleTogether_=a,this.scaleTogether_&&(this.ratio_=this.height_/this.width_),this.broadcastParameter(b.PARAM_NAME_SCALE_TOGETHER))},b.prototype.setVerticalAlign=function(a){this.verticalAlign_=a,this.realign(),this.broadcastParameter(b.PARAM_NAME_VERTICAL_ALIGN)},b.prototype.setWidth=function(a){p["default"](this.width_,a)&&(this.width_=a,this.scaleTogether_&&(this.height_=this.width_*this.ratio_),this.modifySimRect())},b.prototype.zoomIn=function(){this.setHeight(this.height_/this.zoom)},b.prototype.zoomOut=function(){this.setHeight(this.height_*this.zoom)},b}(c["default"]),s.PARAM_NAME_WIDTH="width",s.PARAM_NAME_HEIGHT="height",s.PARAM_NAME_CENTER_X="center-x",s.PARAM_NAME_CENTER_Y="center-y",s.PARAM_NAME_HORIZONTAL_ALIGN="horizontal-align",s.PARAM_NAME_VERTICAL_ALIGN="vertical-align",s.PARAM_NAME_ASPECT_RATIO="aspect-ratio",s.PARAM_NAME_SCALE_TOGETHER="scale X-Y together",s.SIM_RECT_CHANGED="SIM_RECT_CHANGED",a("SimView",s),a("default",s)}}}),System.register("davinci-newton/util/toName.js",[],function(a,b){"use strict";function c(a){return a.toUpperCase().replace(/[ -]/g,"_")}b&&b.id;return a("default",c),{setters:[],execute:function(){}}}),System.register("davinci-newton/util/validName.js",[],function(a,b){"use strict";function c(a){if(!a.match(/^[A-Z_][A-Z_0-9]*$/))throw new Error("not a valid name: "+a);return a}b&&b.id;return a("default",c),{setters:[],execute:function(){}}}),System.register("davinci-newton/objects/AbstractSimObject.js",["../util/toName","../util/validName"],function(a,b){"use strict";var c,d,e;b&&b.id;return{setters:[function(a){c=a},function(a){d=a}],execute:function(){e=function(){function a(b){this.expireTime_=Number.POSITIVE_INFINITY,this.name_=d["default"](c["default"](b||"SIM_OBJ"+a.ID++))}return a.prototype.getExpireTime=function(){return this.expireTime_},a.prototype.setExpireTime=function(a){this.expireTime_=a},a.prototype.getName=function(){return this.name_},a}(),e.ID=1,a("AbstractSimObject",e),a("default",e)}}}),System.register("davinci-newton/math/wedge.js",[],function(a,b){"use strict";function c(a,b){return a.y*b.z-a.z*b.y}function d(a,b){return a.z*b.x-a.x*b.z}function e(a,b){return a.x*b.y-a.y*b.x}b&&b.id;return a("wedgeYZ",c),a("wedgeZX",d),a("wedgeXY",e),{setters:[],execute:function(){}}}),System.register("davinci-newton/math/Bivector3.js",["./wedge"],function(a,b){"use strict";var c,d;b&&b.id;return{setters:[function(a){c=a}],execute:function(){d=function(){function a(){this.yz=0,this.zx=0,this.xy=0}return a.prototype.copy=function(a){return this.yz=a.yz,this.zx=a.zx,this.xy=a.xy,this},a.prototype.dual=function(a){return this.yz=a.x,this.zx=a.y,this.xy=a.z,this},a.prototype.wedge=function(a,b){return this.yz=c.wedgeYZ(a,b),this.zx=c.wedgeZX(a,b),this.xy=c.wedgeXY(a,b),this},a.prototype.zero=function(){return this.yz=0,this.zx=0,this.xy=0,this},a}(),a("Bivector3",d),a("default",d)}}}),System.register("davinci-newton/model/CoordType.js",[],function(a,b){"use strict";var c;b&&b.id;return{setters:[],execute:function(){!function(a){a[a.BODY=0]="BODY",a[a.WORLD=1]="WORLD"}(c||(c={})),a("CoordType",c),a("default",c)}}}),System.register("davinci-newton/model/ForceApp.js",["../objects/AbstractSimObject","../math/Bivector3","./CoordType"],function(a,b){"use strict";var c,d,e,f,g=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b&&b.id;return{setters:[function(a){c=a},function(a){d=a},function(a){e=a}],execute:function(){f=function(a){function b(b,c,e,f,g,h){var i=a.call(this,b)||this;return i.body_=c,i.location_=e,i.locationCoordType_=f,i.direction_=g,i.directionCoordType_=h,i.torque_=new d["default"],i}return g(b,a),b.prototype.getBody=function(){return this.body_},Object.defineProperty(b.prototype,"F",{get:function(){return this.directionCoordType_===e["default"].BODY?this.body_.rotateBodyToWorld(this.direction_):this.direction_},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"x",{get:function(){return this.locationCoordType_===e["default"].BODY?this.body_.bodyToWorld(this.location_):this.location_},enumerable:!0,configurable:!0}),b.prototype.getTorqueAboutCenterOfMass=function(){var a=this.x.subtract(this.body_.X);return this.torque_.wedge(a,this.F)},Object.defineProperty(b.prototype,"Γ",{get:function(){return this.getTorqueAboutCenterOfMass()},enumerable:!0,configurable:!0}),b}(c["default"]),a("ForceApp",f),a("default",f)}}}),System.register("davinci-newton/objects/Spring.js",["./AbstractSimObject","../model/CoordType","../model/ForceApp","../math/Vector"],function(a,b){"use strict";var c,d,e,f,g,h=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};b&&b.id;return{setters:[function(a){c=a},function(a){d=a},function(a){e=a},function(a){f=a}],execute:function(){g=function(a){function b(b,c,d){var e=a.call(this,b)||this;return e.body1_=c,e.body2_=d,e.damping_=0,e.compressOnly_=!1,e.restLength_=1,e.stiffness_=1,e.attach1_=f["default"].ORIGIN,e.attach2_=f["default"].ORIGIN,e}return h(b,a),b.prototype.getStartPoint=function(){if(null==this.attach1_||null==this.body1_)throw new Error;return this.body1_.bodyToWorld(this.attach1_)},b.prototype.getEndPoint=function(){if(null==this.attach2_||null==this.body2_)throw new Error;var a=this.body2_.bodyToWorld(this.attach2_);if(this.compressOnly_){var b=this.getStartPoint(),c=b.distanceTo(a),d=this.restLength_;if(c<=d)return a;var e=a.subtract(b).direction();return b.add(e.multiply(d))}return a},b.prototype.calculateForces=function(){var a=this.getStartPoint(),b=this.getEndPoint(),c=b.subtract(a),g=c.magnitude(),h=-this.stiffness_*(g-this.restLength_),i=-h*(c.x/g),j=-h*(c.y/g),k=-h*(c.z/g),l=new f["default"](i,j,k);if(0!==this.damping_&&(!this.compressOnly_||g<this.restLength_-1e-10)){var m=this.body1_.worldVelocityOfBodyPoint(this.attach1_),n=this.body2_.worldVelocityOfBodyPoint(this.attach2_),o=m.subtract(n).multiply(-this.damping_);l=l.add(o)}return[new e["default"]("spring",this.body1_,a,d["default"].WORLD,l,d["default"].WORLD),new e["default"]("spring",this.body2_,b,d["default"].WORLD,l.multiply(-1),d["default"].WORLD)]},b.prototype.disconnect=function(){},b.prototype.getPotentialEnergy=function(){return 0},b.prototype.getVector=function(){return this.getEndPoint().subtract(this.getStartPoint())},b}(c["default"]),a("Spring",g),a("default",g)}}}),System.register("davinci-newton/util/veryDifferent.js",[],function(a,b){"use strict";function c(a,b,c,d){if(void 0===c&&(c=1e-14),void 0===d&&(d=1),c<=0)throw new Error("epsilon ("+c+") must be positive.");if(d<=0)throw new Error("magnitude ("+d+") must be positive.");var e=Math.max(Math.abs(a),Math.abs(b)),f=e>d?e:d;return Math.abs(a-b)>f*c}b&&b.id;return a("default",c),{setters:[],execute:function(){}}}),System.register("davinci-newton/math/Vector.js",["../util/veryDifferent"],function(a,b){"use strict";var c,d;b&&b.id;return{setters:[function(a){c=a}],execute:function(){d=function(){function a(a,b,c){this.x_=a,this.y_=b,this.z_=c}return Object.defineProperty(a.prototype,"x",{get:function(){return this.x_},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"y",{get:function(){return this.y_},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"z",{get:function(){return this.z_},enumerable:!0,configurable:!0}),a.prototype.add=function(b){return new a(this.x+b.x,this.y+b.y,this.z+b.z)},a.prototype.subtract=function(b){return new a(this.x-b.x,this.y-b.y,this.z-b.z)},a.prototype.multiply=function(b){return new a(b*this.x,b*this.y,b*this.z)},a.prototype.cross=function(b){var c=this.x,d=this.y,e=this.z,f=b.x,g=b.y,h=b.z,i=d*h-e*g,j=e*f-c*h,k=c*g-d*f;return new a(i,j,k)},a.prototype.distanceTo=function(a){var b=this.x-a.x,c=this.y-a.y,d=this.z-a.z;return Math.sqrt(b*b+c*c+d*d)},a.prototype.immutable=function(){return this},a.prototype.magnitude=function(){var a=this.x,b=this.y,c=this.z;return Math.sqrt(a*a+b*b+c*c)},a.prototype.nearEqual=function(a,b){return!c["default"](this.x_,a.x,b)&&(!c["default"](this.y_,a.y,b)&&!c["default"](this.z_,a.z,b))},a.prototype.direction=function(){var a=this.magnitude();if(1!==a){if(0===a)throw new Error("direction is undefined.");return this.multiply(1/a)}return this},a.prototype.rotate=function(a){if(1===a.a&&0===a.xy&&0===a.yz&&0===a.zx)return this;throw new Error("TODO: rotate(spinor)")},a.dual=function(b){return new a((-b.yz),(-b.zx),(-b.xy))},a.fromVector=function(b){return new a(b.x,b.y,b.z)},a}(),d.ORIGIN=new d(0,0,0),a("Vector",d),a("default",d)}}}),System.register("davinci-newton.js",["./davinci-newton/util/CircularList","./davinci-newton/config","./davinci-newton/graph/DisplayGraph","./davinci-newton/model/ForceApp","./davinci-newton/graph/Graph","./davinci-newton/view/LabCanvas","./davinci-newton/engine/RigidBody","./davinci-newton/engine/RigidBodySim","./davinci-newton/model/RungeKutta","./davinci-newton/strategy/SimpleAdvance","./davinci-newton/runner/SimRunner","./davinci-newton/view/SimView","./davinci-newton/objects/Spring","./davinci-newton/math/Vector"],function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;b&&b.id;return{setters:[function(a){c=a},function(a){d=a},function(a){e=a},function(a){f=a},function(a){g=a},function(a){h=a},function(a){i=a},function(a){j=a},function(a){k=a},function(a){l=a},function(a){m=a},function(a){n=a},function(a){o=a},function(a){p=a}],execute:function(){q={get LAST_MODIFIED(){return d["default"].LAST_MODIFIED},get VERSION(){return d["default"].VERSION},get CircularList(){return c["default"]},get DisplayGraph(){return e["default"]},get ForceApp(){return f["default"]},get Graph(){return g["default"]},get LabCanvas(){return h["default"]},get RigidBody(){return i["default"]},get RigidBodySim(){return j["default"]},get RungeKutta(){return k["default"]},get SimpleAdvance(){return l["default"]},get SimRunner(){return m["default"]},get SimView(){return n["default"]},get Spring(){return o["default"]},get Vector(){return p["default"]}},a("default",q)}}});